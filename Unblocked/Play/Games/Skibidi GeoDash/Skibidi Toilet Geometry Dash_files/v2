var YaGames;(()=>{"use strict";var e={202:(e,t,r)=>{r.d(t,{Ts:()=>f,X4:()=>u,Zi:()=>p,fF:()=>g});var n=r(462),o=r(327),a=Object.defineProperty,s=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,l=(e,t,r)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d=(e,t)=>{for(var r in t||(t={}))i.call(t,r)&&l(e,r,t[r]);if(s)for(var r of s(t))c.call(t,r)&&l(e,r,t[r]);return e};const u="YandexSDKLogError";function p(e){var t;let r;try{throw new Error}catch(n){const o=/(\w+)@|at (.+) \(/g,a=e||n.stack||"";if(a.matchAll){const e=Array.from(a.matchAll(o))||[];r=null==(t=e[e.length-1])?void 0:t[2]}}return r}const h=parseInt("1702033910",10)||0;function m(e,t,r){var a,s,i;const c=function(e,t){var r,o;const{message:a,additional:s={}}=(0,n.S)(e.message||String(e)),i={columnNumber:null!=(r=e.columnNumber)?r:-1,fileName:e.fileName||"",lineNumber:null!=(o=e.lineNumber)?o:-1,name:e.name||"Error",message:a,stack:e.stack||""},c={appId:void 0,version:h};return i.additional=d(d(d(d({},e.additional),t.additional),c),s),i}(t,r);r.message&&(c.message=r.message),r.prefix&&(c.message=`${r.prefix} ${c.message}`),o.Z["YaGames"in window?"postToParent":"post"]({data:{block:`ErrorCounter/common: ${e}`,error:c,level:null!=(a=r.level)?a:"error",source:e,sourceMethod:null!=(s=r.sourceMethod)?s:p(c.stack),type:null!=(i=r.type)?i:"error"},type:"error"}).catch(console.warn)}function g(e,t={}){m("sdk",e,t),console.warn(e)}function f(e,t={}){m("sdk-game",e,t),console.error(e,u)}},462:(e,t,r)=>{r.d(t,{S:()=>o,Z:()=>a});const n=[{regexp:new RegExp("User .+ already exists in users list!"),title:"User already exists in users list!"},{regexp:new RegExp("\\(Filename:.+Line: -?[0-9]+\\)"),title:"Unity"},{substr:"UnityEngine",title:"Unity"},{substr:"Dimensions must match",title:"Unity"},{substr:"Loading FSB failed for audio clip",title:"Unity"},{substr:"UnityLoader",title:"Unity"},{substr:"FS.syncfs operations in flight at once, probably just doing extra work",title:"Unity"},{substr:"GLSL",title:"GLSL"},{substr:"ValerypopoffJS plugin",title:"ValerypopoffJS plugin"},{substr:"https://github.com/cocos-creator/engine",title:"cocos-creator"},{substr:"Wicket.Ajax",title:"Wicket.Ajax"},{substr:'Error loading sound "%s"',title:'"loading sound"'},{substr:"Error loading image",title:'"loading image"'},{substr:"Error loading Texture",title:'"loading Texture"'},{substr:"Error loading asset",title:'"loading asset"'},{substr:"Error loading audio url",title:'"loading audio url"'},{substr:"Error loading animation resource",title:'"loading animation resource"'},{substr:"Failed to load resource:",title:'"loading resource"'},{substr:"Could not load",title:'"loading"'},{substr:"Failed to load",title:'"loading"'},{regexp:new RegExp("[Cc]ould not allocate memory"),title:"working with memory"},{substr:"Out of executable memory in function at index",title:"working with memory"},{substr:"memory access out of bounds",title:"working with memory"},{substr:"pre-main prep time: ",title:'"pre-main prep time"'},{substr:"FAILED DIGGING: ",title:'"DIGGING"'},{substr:"sth wrong with connection!",title:'"sth wrong with connection!"'},{substr:"Object2D is not available",title:'"Object2D is not available"'},{regexp:new RegExp("^Client : Error finish action.*?respawn$"),title:'"finish action respawn"'},{substr:"[TokenStorageYandex]",title:"TokenStorageYandex"},{substr:"TOO_SMALL_CONTAINER",title:"TOO_SMALL_CONTAINER"},{substr:"window.cb",title:"window.cb"},{substr:"Not allowed to call RecalculateBounds",title:"Not allowed to call RecalculateBounds"}],o=e=>{for(const t of n)if(t.regexp&&-1!==e.search(t.regexp)||t.substr&&e.includes(t.substr))return{message:`[grouped] Error related to ${t.title}`,additional:{message:e}};return{message:e}},a=e=>{const t=(e=>e.map((e=>{if("object"==typeof e)try{return JSON.stringify(e)}catch(t){return`${e}: ${t.message}`}return String(e)})).join(" "))(e),r=o(t),n=new Error(r.message);return r.additional&&(n.additional=r.additional),n}},422:(e,t,r)=>{r.d(t,{Z:()=>o});class n extends Error{constructor({code:e,httpStatus:t,message:r},o,a){super(r,o,a),this.name="FetchError",this.code=e,this.httpStatus=t,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,n)}toJSON(){return{code:this.code,httpStatus:this.httpStatus,message:this.message,name:this.name,stack:this.stack}}}const o=n},538:(e,t,r)=>{r.d(t,{Z:()=>o});class n extends Error{constructor({code:e,httpStatus:t,message:r},o,a){super(r,o,a),this.name="PaymentsError",this.code=e,this.httpStatus=t,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,n)}toJSON(){return{code:this.code,httpStatus:this.httpStatus,message:this.message,name:this.name,stack:this.stack}}}const o=n},327:(e,t,r)=>{r.d(t,{Z:()=>y});var n=r(202);class o extends Error{constructor({code:e,message:t},r,n){super(t,r,n),this.name="AuthError",this.code=e,Object.setPrototypeOf(this,o.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,o)}toJSON(){return{code:this.code,message:this.message,name:this.name,stack:this.stack}}}const a=o;var s=r(422),i=r(538);const c={AuthError:a,FetchError:s.Z,PaymentsError:i.Z};var l=Object.defineProperty,d=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,h=(e,t,r)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,m=(e,t)=>{for(var r in t||(t={}))u.call(t,r)&&h(e,r,t[r]);if(d)for(var r of d(t))p.call(t,r)&&h(e,r,t[r]);return e};class g{constructor(){this.suppressNoGameFrameWarning=!1,this._promises=Object.create(null),this._externalListeners=Object.create(null),this._internalListeners=Object.create(null),this._addEventListener()}get _parentTarget(){return window.parent!==window?window.parent:void 0}get _gameFrame(){const e=function(){const e=window.YandexGamesSDK&&window.YandexGamesSDK.FRAME_ID;if(e&&"string"==typeof e){const t=document.getElementById(e);if(t)return t}}();return e||this.suppressNoGameFrameWarning||console.warn("No game frame to post"),e}get _gameFrameAllowedOrigins(){var e;try{const t=null==(e=this._gameFrame)?void 0:e.dataset.allowedOrigins;if(!t)return;return JSON.parse(t)}catch(e){return}}get _childTarget(){var e;return null==(e=this._gameFrame)?void 0:e.contentWindow}_addEventListener(){window.addEventListener("message",(e=>{const{source:t}=e.data||{};"YandexGamesSDK"===t&&this._handleEvent(e)}))}_handleEvent(e){const{type:t,action:r,messageId:o,originMessageId:a,payload:s,originPayload:i,data:l,error:d,errorJSON:u}=e.data||{},p=this._promises[a];p&&(this.deletePromise(a),void 0===d?p.resolve({type:t,action:r,originPayload:i,data:l}):p.reject(function({error:e,errorJSON:t}){if(t)try{const e=JSON.parse(t);if(e&&e.name in c)return new c[e.name](e)}catch(e){(0,n.fF)(e)}return new Error(e||"")}({error:d,errorJSON:u})));const h=(e={})=>{const n={type:e.type||t,action:e.action||r,originMessageId:o,originPayload:s,data:e.data||{}};!function(e,t){t.error&&(e.error=String(t.error.message)||null,e.errorJSON=JSON.stringify(t.error)||null)}(n,e),this.postCallbackToChild(n)};const m=this._externalListeners[t]||[];for(const t of m)try{t(e,h)}catch(e){(0,n.fF)(e)}}onAllMessages(e,t){this.onExternalMessage(e,t),this.onInternalMessage(e,t)}offAllMessages(e,t){this.offExternalMessage(e,t),this.offInternalMessage(e,t)}onExternalMessage(e,t){this._onMessage(this._externalListeners,e,t)}offExternalMessage(e,t){this._offMessage(this._externalListeners,e,t)}onInternalMessage(e,t){this._onMessage(this._internalListeners,e,t)}offInternalMessage(e,t){this._offMessage(this._internalListeners,e,t)}_onMessage(e,t,r){if("string"==typeof t&&(t=[t]),!Array.isArray(t))throw new Error('Wrong argument "types"');for(const n of t)n in e||(e[n]=[]),e[n].push(r)}_offMessage(e,t,r){if("string"==typeof t&&(t=[t]),!Array.isArray(t))throw new Error('Wrong argument "types"');for(const n of t)n in e&&(e[n]=e[n].filter((e=>e!==r)))}externalPost(e){this._handleEvent(e)}post(e){return this.postEventDataToListeners(e,this._internalListeners[e.type])}postEventDataToListeners(e,t=[]){const{action:r,type:o}=e;return new Promise((a=>{const s=`${Date.now()}-${Math.random()}`,i=(e={})=>{const t={action:e.action||r,data:e.data||{},errorInstance:e.error,originMessageId:s,type:e.type||o};a(t)};for(const r of t)try{r({data:m({},e)},i)}catch(e){(0,n.fF)(e)}}))}hasParent(){return Boolean(this._parentTarget)}postToParent(e){const t=this._parentTarget;return t?this._post(t,e):Promise.reject(new Error("No parent to post message"))}hasChild(){this.suppressNoGameFrameWarning=!0;const e=Boolean(this._childTarget);return this.suppressNoGameFrameWarning=!1,e}postToChild(e){const t=this._childTarget;return t?this._post(t,e):Promise.reject(new Error(`No child to post message: type = ${e.type}, action = ${e.action}`))}postCallbackToChild(e){const t=this._childTarget;return t?this._post(t,e):Promise.reject(new Error(`No child to post message: type = ${e.type}, action = ${e.action}`))}clearPromiseWaitTimeout(e){const t=this._promises[e];(null==t?void 0:t.timeoutId)&&(window.clearTimeout(t.timeoutId),delete t.timeoutId)}deletePromise(e){this.clearPromiseWaitTimeout(e),delete this._promises[e]}_post(e,t){const r=Date.now(),o=`${r}-${Math.random()}`;t=Object.assign({},t,{source:"YandexGamesSDK",messageId:o});let a=e=>{},s=e=>{};const i=new Promise(((e,t)=>{a=e,s=t}));this._promises[o]={promise:i,resolve:a,reject:s,time:r};try{e.postMessage(t,"*")}catch(e){return this.deletePromise(o),Promise.reject(e)}if("timeout"in t){const{timeout:e}=t;"number"==typeof e&&e>0?this._promises[o].timeoutId=window.setTimeout((()=>{this.deletePromise(o),s(new Error("Message rejected by timeout"))}),e):(0,n.fF)(new Error("Wrong timeout value"))}return i}}let f;if("object"==typeof window)window.YandexGamesSDKGlobals=window.YandexGamesSDKGlobals||{},window.YandexGamesSDKGlobals.messaging||(window.YandexGamesSDKGlobals.messaging=new g),f=window.YandexGamesSDKGlobals.messaging;else{const e=()=>{throw new Error("Not impl")},t=e=>Promise.reject(new Error("Not impl"));f={externalPost:t=>e,hasChild:()=>!1,hasParent:()=>!1,offAllMessages:e,offExternalMessage:e,offInternalMessage:e,onAllMessages:e,onExternalMessage:e,onInternalMessage:e,post:t,postToChild:t,postToParent:t}}const y=f},591:(e,t,r)=>{r.d(t,{$g:()=>i,H8:()=>c,mv:()=>d,rh:()=>l});var n=r(160),o=r(42),a=r(828),s=r(159);function i(e){const t={};d()&&(t.draft="true");const r=l();return r&&(t["app-id"]=r),(0,n.Z)({url:e,params:t})}function c(e){return"1"===(0,o.VB)("revert_unique_id")?(0,n.Z)({url:e,params:{revert_unique_id:"1"}}):e}function l(){var e,t,r;return"undefined"==typeof window?"":(null==(e=window.YandexGamesSDK)?void 0:e.environment)?window.YandexGamesSDK.environment.app.id:window.YandexGamesSDKEnvironment?window.YandexGamesSDKEnvironment.app.id:((0,a.H)({block:s.W.UTILS_LOCATION,level:null==(r=null==(t=window.Ya)?void 0:t.Rum)?void 0:r.ERROR_LEVEL.ERROR},new Error("Can not get appId from environment")),"")}function d(e=window){var t;return(null==(t=e.YandexGamesSDK)?void 0:t.game)?e.YandexGamesSDK.game.info.isDraft:"true"===(0,o.VB)("draft")}},510:(e,t,r)=>{r.d(t,{Z:()=>c});var n=r(202),o=r(327),a=r(591),s=r(651);const i=Object.create(null),c={init(){},sendOnceDeprecatedUsage(e){e in i||(i[e]=1,this.params({borrowParams:{sdkDeprecatedUsage:{key:e,appId:(0,a.rh)()}},service:s.m_}))},params(e){o.Z.postToParent({type:"metrika",action:"params",data:e}).catch((e=>{(0,n.fF)(e)}))},reachGoal(e,t,r){o.Z.postToParent({type:"metrika",action:"reachGoal",data:{data:t,goal:e,params:r}}).catch((e=>{(0,n.fF)(e)}))}}},160:(e,t,r)=>{function n(e){const{url:t,params:r={},hash:n={},removed:a=[],encoded:s=!0}=e;if(!t)throw new Error("addGetParams: function has no url");const i=t.split("#"),c=i[0].split("?");let l=o(c,r,s,a),d=o(i,n,s,a);return l&&(l=`?${l}`),d&&(d=`#${d}`),`${c[0]}${l}${d}`}function o(e,t,r,n){return e.length>1&&e[1].length&&e[1].split("&").forEach((e=>{const[r,n]=e.split("=");if(!t[r])try{t[r]=decodeURIComponent(n)}catch(e){t[r]=n}})),Object.keys(t).filter((e=>!n.includes(e))).filter((e=>void 0!==e)).map((e=>`${e}=${r?encodeURIComponent(t[e]):t[e]}`)).join("&")}r.d(t,{Z:()=>n})},651:(e,t,r)=>{r.d(t,{Tc:()=>l,m_:()=>c});var n,o,a,s,i=r(776);"undefined"!=typeof navigator&&navigator;const c="undefined"!=typeof window&&((null==(o=null==(n=window.YandexGamesSDK)?void 0:n.environment)?void 0:o.serviceName)||(null==(a=window.YandexGamesSDKEnvironment)?void 0:a.serviceName)||(null==(s=window.clientMetadata)?void 0:s.serviceName))||i.Go0.YANDEX,l=5e3},42:(e,t,r)=>{r.d(t,{VB:()=>o});r(751);var n=r(399);Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function o(e,t){var r,o;return t?"string"==typeof t.entryQuery[e]?t.entryQuery[e]:void 0:"object"==typeof window?(null==(o=null==(r=window.appData)?void 0:r.location)?void 0:o.entryQuery[e])||(0,n.Z)(window.location)[e]:void 0}},399:(e,t,r)=>{function n(e,t=!0){const r=Object.create(null);return[e.hash.replace(/^#/,""),e.search.replace(/^\?/,"")].join("&").split("&").filter(Boolean).forEach((e=>{const[n,o]=e.split("=");try{r[n]=t?decodeURIComponent(o):o}catch(e){console.warn(e)}})),r}r.d(t,{Z:()=>n})},540:(e,t,r)=>{r.d(t,{u:()=>n});const n=()=>{var e,t;return Boolean((()=>{var e;return Boolean("undefined"!=typeof window&&(null==(e=null==window?void 0:window.Ya)?void 0:e.Rum))})()&&(null==(t=null==(e=window.Ya)?void 0:e.Rum)?void 0:t.logError))}},828:(e,t,r)=>{r.d(t,{H:()=>m});var n=r(159);const o=[{regexp:new RegExp(/Monetization error \[yandex]: yandex error - Container with id .* is hidden/),title:"Monetization error [yandex]: yandex error - Container is hidden"},{regexp:new RegExp(/Monetization error \[google]: yandex error - Container with id .* is hidden/),title:"Monetization error [google]: yandex error - Container is hidden"},{regexp:new RegExp(/Monetization error \[yandex]: yandex error - Container with id .* is not found \(init\)/),title:"Monetization error [yandex]: yandex error - Container is not found (init)"},{regexp:new RegExp(/Monetization error \[google]: yandex error - Container with id .* is not found \(init\)/),title:"Monetization error [google]: yandex error - Container is not found (init)"},{substr:"[SW] Trouble with registration; Failed to register a ServiceWorker",title:"[SW] Trouble with registration; Failed to register a ServiceWorker"},{substr:"window.cb",title:"Error related to window.cb"}],a=(e,t)=>{var r;if(!e.startsWith("[SW]"))return t;const n=null==(r=e.split(": ").pop())?void 0:r.trim();return n===e?t:`${t}: ${n}`};var s=r(540),i=Object.defineProperty,c=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,u=(e,t,r)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,p=(e,t)=>{for(var r in t||(t={}))l.call(t,r)&&u(e,r,t[r]);if(c)for(var r of c(t))d.call(t,r)&&u(e,r,t[r]);return e};function h(){var e,t,r;try{throw new Error}catch(n){const o=/(\w+)@|at (.+) \(/g,a=n.stack||"";if(a.matchAll){const n=Array.from(a.matchAll(o))||[];return(null==(e=n[2])?void 0:e[2])||(null==(t=n[1])?void 0:t[2])||(null==(r=n[0])?void 0:r[2])}return}}const m=function(e,t){var r,i,u,m,g;if(!(0,s.u)())return;let f=e,{additional:y,level:w,message:v,prefix:b,source:E="catalog",sourceMethod:P}=f,_=((e,t)=>{var r={};for(var n in e)l.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&c)for(var n of c(e))t.indexOf(n)<0&&d.call(e,n)&&(r[n]=e[n]);return r})(f,["additional","level","message","prefix","source","sourceMethod"]);const{message:O,additional:S}=(e=>{for(const t of o)if(t.regexp&&-1!==e.search(t.regexp)||t.substr&&e.includes(t.substr))return{message:`[grouped] ${a(e,t.title)}`,additional:{message:e}};return{message:e}})(v||(null==t?void 0:t.message)||String(e));v=O,w=w||(null==(i=null==(r=window.Ya)?void 0:r.Rum)?void 0:i.ERROR_LEVEL.ERROR)||"error",t=t||e,S&&(y=p({additional:y},S)),b&&(v=`${b} ${v}`);const A=p({additional:y,block:null!=(u=_.block)?u:n.W.RUM_UNSPECIFIED,ignoreErrorMessage:!0,level:w,message:v,source:E,sourceMethod:P||h()},_);null==(g=null==(m=window.Ya)?void 0:m.Rum)||g.logError(A,t)}},776:(e,t,r)=>{r.d(t,{xYt:()=>g,NAu:()=>m,Go0:()=>O,p4F:()=>E,dsH:()=>_,x2l:()=>P,SBp:()=>v,U_6:()=>p});const n=["com"],o={az:["az"],by:["be","ru"],"co.il":["he"],com:["en","af","am","ar","az","be","bg","bn","ca","cs","da","de","el","en","es","et","eu","fa","fi","fr","gl","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km","kn","ko","ky","lo","lt","lv","mk","ml","mn","mr","ms","my","ne","nl","no","pl","pt","ro","ru","si","sk","sl","sr","sv","sw","ta","te","tg","th","tk","tl","tr","uk","ur","uz","vi","zh","zu"],"com.am":["hy"],"com.ge":["ka"],"com.tr":["tr"],ee:["et"],fr:["fr","en"],kz:["kk","ru"],lt:["lt"],lv:["lv"],md:["ro"],ru:["ru","en","be","uk","kk","uz"],tj:["tg"],tm:["tk"],uz:["uz"]};Object.keys(o).reduce(((e,t)=>(e[t]=o[t][0],e)),{});var a=Object.defineProperty,s=Object.defineProperties,i=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,u=(e,t,r)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var p=(e=>(e.PLAYHOP="playhop",e.YA="ya",e.YANDEX="yandex",e))(p||{});var h=(e=>(e.ANDROID_OTHER="android_other",e.ANDROID_STANDALONE="android_standalone",e.ANDROID_TV="tv_android",e.ANDROID_YABRO="android_yabro",e.ANDROID_YASEARCH="android_yasearch",e.DESKTOP_OTHER="desktop_other",e.IGROTOK_APP_ANDROID="igrotok_app_android",e.IGROTOK_LITE="igrotok_app_lite",e.IOS_CHROME="ios_chrome",e.IOS_OTHER="ios_other",e.IOS_SAFARI="ios_safari",e.IOS_SUPERAPP="ios_superapp",e.MOBILE_OTHER="mobile_other",e))(h||{});var m=(e=>(e.HOP="HOP",e.YAN="YAN",e))(m||{});Object.freeze(Object.values(h).reduce(((e,t)=>{return r=((e,t)=>{for(var r in t||(t={}))l.call(t,r)&&u(e,r,t[r]);if(c)for(var r of c(t))d.call(t,r)&&u(e,r,t[r]);return e})({},e),s(r,i({[t]:t}));var r}),{}));var g=(e=>(e.ADAPTIVE_RECOMMENDED_NEW="adaptive_recommended_new",e.CATEGORIZED_NEW_L="categorized_new_l",e.L="l",e.M="m",e.PAGE_ICON_DESKTOP="page_icon_desktop",e.PAGE_ICON_DESKTOP_WITH_PLAY="page_icon_desktop_with_play",e.PAGE_ICON_MOBILE="page_icon_mobile",e.PAGE_ICON_MOBILE_WITH_PLAY="page_icon_mobile_with_play",e.PAGE_SCROLLED_ICON_MOBILE="page_scrolled_icon_mobile",e.PREMIUM="premium",e.PREMIUM_BIG="premium_big",e.PROFILE_RECENT_GAMES="profile_recent_games",e.PROMO_BAR="promo_bar",e.RECOMMENDED_NEW="recommended_new",e.S="s",e.SIZE_22="size22",e.SIZE_36="size36",e.SIZE_48="size48",e.SIZE_84_LOW="size84_low",e.TV="tv",e.YOUR_GAMES="your_games",e.YOUR_GAMES_FORCE="your_games_force",e))(g||{});Object.values({en:"com",kk:"kz",be:"by",ru:"ru",uz:"uz"});function f(e,t){return t.reduce(((t,r)=>{var n;return t.push(...(n=`https://${e}.${r}`,[n,n.replace("https://","https://*.")])),t}),[])}f("yandex",["by","com","kz","ru","uz"]).concat(f("playhop",n)).concat(f("ya",["ru"])).concat(["https://zenadservices.net"]);const y=`(yandex\\.(${["az","by","co.il","com","com.am","com.ge","com.tr","ee","fr","kz","lt","lv","md","ru","tj","tm","uz"].map((e=>e.replace(".","\\."))).join("|")})|ya\\.ru)`,w=(new RegExp(y),new RegExp(`^https://(www\\.)?${y}$`),new RegExp(`^https://([^.]+\\.){0,7}${y}\\/`),`(playhop\\.(${n.map((e=>e.replace(".","\\."))).join("|")}))`),v=(new RegExp(w),new RegExp(`^https://([^.]+\\.){0,7}${w}$`)),b=`(igrotok|igrotok-test|igrotok\\.msup|igrotok\\.games-test|igrotok\\.games-prestable|igrotok\\.crowdtest\\.games)\\.(yandex|ya)\\.(${["com","ru"].map((e=>e.replace(".","\\."))).join("|")})`;new RegExp(b),new RegExp(`^https://${b}$`),new RegExp(`^(?:https://)?(?:([^.]+)\\.)?crowdtest\\.games\\.(${y})`),new RegExp(`^https://([^.]+\\.){0,7}${y}/games/igrotok`),new RegExp(`^https?://(?:[^.]+\\.){0,7}${y}/games/manifest/app/\\d+/?`),new RegExp(`^https?://(?:[^.]+\\.){0,7}${y}/games/manifest/catalogue/.*`),new RegExp(`^https?://(?:[^.]+\\.){0,7}${y}/games/manifest/sdk/.*`);const E="from-gametok",P="is-gametok",_="igrotok_mode";var O=(e=>(e.IGROTOK="igrotok",e.IGROYAL="igroyal",e.PLAYHOP="playhop",e.YANDEX="yandex",e))(O||{})},159:(e,t,r)=>{r.d(t,{W:()=>n});var n=(e=>(e.ADV_STICKY="AdvSticky",e.APP_COMPONENT="App: component",e.APP_PAGE="App: page",e.AUTH="Auth",e.BUNDLES_PLAY="Bundles play",e.CATALOG="Catalog",e.ERROR_BOUNDARY="Error boundary",e.ERROR_COUNTER="Error counter",e.GAME_IMAGE="GameImage",e.GAMETOK="Gametok",e.GOOGLE_ADS="Google ads",e.I18N="i18n",e.METRIKA="Metrika",e.MONETIZATION="Monetization",e.OFFLINE_MOD_HELPER="Offline mod helper",e.PARTNER="Embedding in partner",e.PLAY_TO_EARN="Play2Earn",e.POLYFILL="Polyfill",e.REDUX="Redux",e.REDUX_GAMETOK="Redux in Gametok",e.RUM_NATIVE_ERROR="Rum: native error in catalog",e.RUM_UNSPECIFIED="Rum: unspecified error without block",e.SERVER_MIDDLEWARE="Server middleware",e.SERVICE_WORKER_REGISTRATION="ServiceWorker Registration",e.SERVICE_WORKER_UNREGISTRATION="ServiceWorker Unregistration",e.SHORTCUTS_POPUP_MANAGER="ShortcutsPopupManager",e.SIMILAR_GAMES="Similar games",e.SSE="Notify API",e.TURBO_APP="Turbo app",e.TV="tv",e.UTILS_LOCATION="Utils: location",e.UTILS_UNIVERSAL="Utils: universal",e.VIDEO_LOADER="Video loader",e.WAIT_TTI="Wait TTI",e.XSOLLA="Xsolla",e))(n||{})},419:e=>{function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,r,n,o){r=r||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(r);var i=1e3;o&&"number"==typeof o.maxKeys&&(i=o.maxKeys);var c=e.length;i>0&&c>i&&(c=i);for(var l=0;l<c;++l){var d,u,p,h,m=e[l].replace(s,"%20"),g=m.indexOf(n);g>=0?(d=m.substr(0,g),u=m.substr(g+1)):(d=m,u="");try{p=decodeURIComponent(d),h=decodeURIComponent(u)}catch(e){console.warn(e);continue}t(a,p)?Array.isArray(a[p])?a[p].push(h):a[p]=[a[p],h]:a[p]=h}return a}},509:e=>{var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,r,n,o){return r=r||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(o){var a=encodeURIComponent(t(o))+n;return Array.isArray(e[o])?e[o].map((function(e){return a+encodeURIComponent(t(e))})).join(r):a+encodeURIComponent(t(e[o]))})).filter(Boolean).join(r):o?encodeURIComponent(t(o))+n+encodeURIComponent(t(e)):""}},751:(e,t,r)=>{t.decode=t.parse=r(419),t.encode=t.stringify=r(509)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{if(void 0!==r){var e=r.u,t=r.e,n={},o={};r.u=function(t){return e(t)+(n.hasOwnProperty(t)?"?"+n[t]:"")},r.e=function(n){return t(n).catch((function(t){var a=o.hasOwnProperty(n)?o[n]:3;if(a<1){var s=e(n);throw t.message="Loading chunk "+n+" failed after 3 retries.\n("+s+")",t.request=s,t}return new Promise((function(e){setTimeout((function(){o[n]=a-1,e(r.e(n))}),0)}))}))}}})();var n={};(()=>{r.d(n,{default:()=>oo});var e=(e=>(e.ABORT_CONTROLLER="abort-controller",e.INTERSECTION_OBSERVER="intersection-observer",e.LEGACY="legacy",e.SMOOTH_SCROLL="smooth-scroll",e))(e||{});var t=r(828);const o=e=>{const{async:t,content:r,crossorigin:n,id:o,nonce:a,onErrCb:s,onLoadCb:i,parentElement:c,src:l}=e,d=document.createElement("script");if(i&&(d.onload=i),s&&(d.onerror=s),d.type="text/javascript",t&&(d.async=t),l&&(d.src=l),a&&d.setAttribute("nonce",a),n&&d.setAttribute("crossorigin",n),o&&(d.setAttribute("id",`${o}-script`),d.dataset.rCid=`load-script-${o}`),r){const e=document.createTextNode(r);d.appendChild(e)}c?c.appendChild(d):document.body.appendChild(d)};var a=r(159);function s(e,t){return e.endsWith("/")||(e=`${e}/`),`${e}polyfill/${t}`}function i(e,t){return s(e,function(e){var t,r;return(null==(r=null==(t=window.loadPolyfillHash)?void 0:t[e])?void 0:r.contenthash)?`${e}.${window.loadPolyfillHash[e].contenthash}.js`:`${e}.js`}(t))}var c=r(202),l=r(327);const d=()=>{["click","dblclick","mouseup","pointerup","touchend"].forEach((e=>{var t;document.addEventListener(e,(t=`${e}-on-body`,()=>{window.top&&window.top.postMessage({type:"document-events",action:t},"*")}),!0)}))};var u=r(591);var p=r(776);function h(e=""){return e.endsWith(`${p.U_6.YA}.ru`)}function m(e,t="ru",r){return e=e.replace("%TLD%",t),"ru"===t&&h(r)&&(e=e.replace(`${p.U_6.YANDEX}.ru`,`${p.U_6.YA}.ru`)),e}const g=["ru","uk","be","kk","uz"],f=1e3,y=60*f;class w{static SetFlag(e,t){return e|t}static UnsetFlag(e,t){return e&~t}static HasFlag(e,t){return(e&t)===t}static ToggleFlag(e,t){return e^t}}function v(e){const t=this.constructor.prototype[e],r=function(){return t.apply(r,arguments)};return Object.setPrototypeOf(r,this.constructor.prototype),Object.getOwnPropertyNames(t).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})),r}v.prototype=Object.create(Function.prototype);const b=v;var E=(e=>(e.Adv="Adv",e.Auth="Auth",e.Dev="Dev",e.Popup="Popup",e.Test="Test",e.Unknown="Unknown",e))(E||{});const P=[],_=(Date.now(),(()=>{var e;if("object"!=typeof window)return 0;const t=String(window.location).match("debug-mode(=(\\d+))?");return t?t[1]?parseInt(null!=(e=t[2])?e:"0",10):1:0})()),O=Boolean(_),S=class e extends b{constructor(t,r,n){var o,a;super("log"),this.spoilerData=[],this.spoiler=(...e)=>(this.spoilerData.push(e),this),this.spoilerFunc=e=>(this.spoilerData.push([e()]),this),this.tag=t=>new e(this.prefix,this.initialTag.concat(t),this.color),this.prefix=t,this.color=n,this.initialTag=[].concat(r),this.label=this.initialTag.join("|"),this.prefixStyle=`\n            background: ${null!=(o=null==n?void 0:n.background)?o:"peru"};\n            color: ${null!=(a=null==n?void 0:n.text)?a:"black"};\n            font-size: 8px;\n            font-weight: normal;\n            border-radius: 0 4px 4px 0;\n            padding: 2px;\n        `}static GetLogSize(){return O?1e3:300}static GetLogFunc(){return 0===_?"dummyLog":w.HasFlag(_,2)?"extendedLog":"simpleLog"}dummyLog(...e){}simpleLog(...t){console.log(`%c${this.label}%c${this.prefix}%c`,e.labelStyle,this.prefixStyle,e.dataStyle,...t)}extendedLog(...t){if(console.groupCollapsed(`%c${this.label}%c${this.prefix}%c`,e.labelStyle,this.prefixStyle,e.dataStyle,...t),this.spoilerData.length){for(const e of this.spoilerData)console.log(...e);this.spoilerData=[]}console.trace(),console.groupEnd()}clientLog(...t){const r=Math.max(0,P.length-e.LOG_SIZE+1);r>0&&P.splice(0,Math.max(r,.1*e.LOG_SIZE));let n=x(t);n.reduce(((e,t)=>e+t.length),0)>1e3&&(n=["Error: Stringified data is too big."]);const o={data:n,prefix:this.prefix,tag:this.initialTag,time:Date.now()};this.color&&(o.color=this.color),this.spoilerData.length&&(o.spoilerData=x(this.spoilerData)),P.push(o)}log(...t){"object"==typeof window&&this.clientLog(...t),this[e.LOG_FUNC](...t)}};S.labelStyle="\n        background: dimgrey;\n        color: darkgrey;\n        font-size: 8px;\n        font-weight: normal;\n        border-radius:4px 0 0 4px;\n        padding: 2px\n    ",S.dataStyle="font-weight: normal;",S.LOG_SIZE=S.GetLogSize(),S.LOG_FUNC=S.GetLogFunc();let A=S;const I=(e,t="Unknown",r)=>new A(e,t,r);function x(e){try{return e.map((e=>"object"==typeof e?function(e,t=1){const r=new WeakMap;return JSON.stringify(function e(t,n){if(!t||"object"!=typeof t)return t;let o,a=Array.isArray(t),s=r.has(t);return r.set(t,!0),s?o:(JSON.stringify(t,(function(r,s){if(a||n>0){if(!r)return a=Array.isArray(s),t=s,s;!o&&(o=a?[]:{}),o[r]=e(s,a?n:n-1)}})),void 0===o?a?[]:{}:o)}(e,t))}(e,2):String(e)))}catch(e){return["Error: Can not stringifyArrayObjects"]}}var T,k=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},D=(e,t,r,n)=>(k(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);T=new WeakMap;const R=class{constructor(){((e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)})(this,T,0),this.promise=new Promise(((e,t)=>{this.resolve=t=>{D(this,T,1),e(t)},this.reject=e=>{D(this,T,2),t(e)}}))}get state(){return k(e=this,t=T,"read from private field"),r?r.call(e):t.get(e);var e,t,r}},C=I("sdkTimeout",[E.Dev]);function L(e,t=function(){var e;switch(null==(e=navigator.connection)?void 0:e.effectiveType){case"slow-2g":return 40*f;case"2g":return 20*f;case"3g":return 10*f;default:return 5*f}}()){const r=new R;C("init",e),r.promise.catch((()=>{var r;const n=new Error(`[SDK] to long resolve for method '${e}'`);n.additional={speed:(null==(r=navigator.connection)?void 0:r.effectiveType)||"unknown",timeout:t},C("timeout",e),(0,c.fF)(n)}));const n=setTimeout((()=>{r.reject()}),t);return()=>{C("resolve",e),r.resolve(),clearTimeout(n)}}class N{constructor(e){this.log=e,this.observers={},this.subscribe=(e,t)=>{var r,n;return(null!=(n=(r=this.observers)[e])?n:r[e]=[]).push(t),this.unsubscribe.bind(this,e,t)},this.unsubscribe=(e,t)=>{if(!t)return void delete this.observers[e];const r=this.observers[e],n=r.indexOf(t);-1!==n&&r.splice(n,1)},this.notifyObservers=(e,t)=>e.forEach((e=>{const r=this.observers[e];r&&r.forEach((r=>{var n;try{r(t)}catch(t){null==(n=this.log)||n.call(this,`${e} event observer error`,t)}}))}))}}var M=(e,t,r)=>new Promise(((n,o)=>{var a=e=>{try{i(r.next(e))}catch(e){o(e)}},s=e=>{try{i(r.throw(e))}catch(e){o(e)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,s);i((r=r.apply(e,t)).next())}));const j={background:"#6c5b7b",text:"#ffffff"},$=class{constructor(){this.log=I("Achievements | Child frame",E.Dev,j),this.observable=new N(this.log),this.setProgress=(e,t)=>M(this,null,(function*(){return this.post("setProgress",{id:e,progress:t})})),this.getProgress=e=>M(this,null,(function*(){return this.post("getProgress",{id:e})})),this.getList=(...e)=>M(this,[...e],(function*(e=["allLocal"]){return this.post("getList",{status:e})})),this.on=({action:e,id:t=""},r)=>this.observable.subscribe(this.buildId(e,t),r),this.off=({action:e,id:t},r)=>this.observable.unsubscribe(this.buildId(e,t),r),this.post=(e,t)=>M(this,null,(function*(){this.log("post to parent",e,t);const r=L(`AchvManager.${e}`);return l.Z.postToParent({action:e,type:"achv-manager",data:t}).then((r=>{this.log("receive from parent",e,r);const{result:n,success:o,error:a}=r.data;return o&&n?(this.notify(e,t,n),n):(this.log("reject",e,"due to error"),Promise.reject(a))})).finally((()=>{r()}))})),this.notify=(e,t,r)=>{const n=[this.buildId(e)];t.id&&n.push(this.buildId(e,t.id)),this.observable.notifyObservers(n,{data:r,payload:t})},this.buildId=(e,t="")=>`${e}${t}`}};$.init=()=>{const{getList:e,getProgress:t,off:r,on:n,setProgress:o}=new $;return{getList:e,getProgress:t,off:r,on:n,setProgress:o}};let G=$;const F=I("NoAds",[E.Adv]),Y="yandex-games-no-ads-style";function U(){Array.isArray(window.yaContextCb)&&0!==window.yaContextCb.length&&(window.yaContextCb=[]),Array.isArray(window.yandexContextAsyncCallbacks)&&0!==window.yandexContextAsyncCallbacks.length&&(window.yandexContextAsyncCallbacks=[])}let Z=!1;function W(){Z||(Z=!0,F("_disableAds"),B(),function(){var e,t,r;const n={destroy(){F("Ya.Context.AdvManager.destroy disabled")},render(e,t){"function"==typeof t?t():"function"==typeof e.altCallback?e.altCallback():"function"==typeof e.onError&&e.onError({code:"YA_GAMES_ADS_DISABLED",text:"",type:"error"})}};"function"==typeof(null==(r=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:r.render)&&(window.Ya.Context.AdvManager.render=n.render),U();let o=window.Ya;Object.defineProperty(window,"Ya",{get(){var e;return(null==(e=null==o?void 0:o.Context)?void 0:e.AdvManager)&&o.Context.AdvManager!==n&&(o.Context.AdvManager=n),U(),o},set(e){var t;(null==(t=e.Context)?void 0:t.AdvManager)&&e.Context.AdvManager!==n&&(e.Context.AdvManager=n),o=e},enumerable:!0,configurable:!0}),window.Ya=window.Ya||{},window.Ya.Context=window.Ya.Context||{AdvManager:n},window.Ya.Context.AdvManager=n,F("disable Ya.Context.AdvManager.render")}())}function B(){!function(){var e;if(document.getElementById(Y))return;const t=document.createElement("style");t.id=Y,t.textContent='\nbody div[id*="yandex_rtb"],\nbody div[id*="adfox"],\nbody iframe#bwiframe,\nbody iframe[src*="yabnrwall.html"],\nbody iframe[src*="yartbbnr.html"],\nbody yatag,\nbody yatag[class]\n{ display: none !important; }',null==(e=document.body)||e.appendChild(t)}()}function K(e){return function(e,t){if("function"!=typeof t)throw new Error("Argument is not a function");let r;return function(...n){return--e>0&&t&&(r=t.apply(this,n)),e<=1&&(t=void 0),r}}(2,e)}var H=r(42);function V(){return"undefined"!=typeof window&&-1!==window.location.href.toLowerCase().indexOf("is_igroyal=1")}const z="2795",q=(e,r,n)=>{const o=/^((?!chrome|android).)*safari/i.test(window.navigator.userAgent)?7500:15e3,s=null!=n?n:o,i=window.setTimeout((()=>{(e=>{(0,t.H)({block:a.W.WAIT_TTI,level:"warn",message:`[startWaitingTTI] Time to interactive took more than ${e/1e3}s`})})(s),c()}),s),c=K((()=>{window.clearTimeout(i),e()}));r(c)},J=(e,t)=>{q(e,(e=>{var t,r,n,o;(null==(t=window.Ya)?void 0:t.Rum)&&!(null==(r=window.Ya)?void 0:r.Rum.getTimeMarks()[z])?null==(o=null==(n=window.Ya)?void 0:n.Rum)||o.on(z,e):e()}),t)},X="cf_mirror_static",Q="tti_metrica_waiting_timeout";function ee(e){var t;return(null==(t=e.abt)?void 0:t.flags)||e}function te(e,t){return ee(e)[t]}function re(e,t,r){return te(e,t)===r}function ne(e,t,r){const n=te(e,t);return"array"===r?Array.isArray(n)?n:void 0:"object"!==r||n?"number"===r?"number"!=typeof n||isNaN(n)?void 0:n:typeof n===r?n:void 0:void 0}function oe(e,t){return ne(e,t,"number")}const ae=I("PixelManager");const se=new class{constructor(){this.pixelStorage={}}get pixelsToInit(){var e,t,r;if("undefined"==typeof window)return[];let n=`${window.appData.cdnUrl}/games-static/static-data/pixels/google-tag-manager.html`;return re(null!=(r=null==(t=null==(e=window.appData)?void 0:e.abt)?void 0:t.flags)?r:{},X,!0)&&(n="https://statics.games-storage-aws.yandex.net/statics/pixels/google-tag-manager.html"),this.pixelsOrigin=new URL(n).origin,[{frameURL:n,pixelName:"google_tag_manger",sendPixelEventFunc:this.sendGoogleTagMangerEvent.bind(this)}]}init(){window.appData.isWorldWide&&this.pixelsToInit.forEach((e=>{const{frameURL:t,pixelName:r,sendPixelEventFunc:n}=e;this.createPixelIframe(t,r,n)}))}sendEvent(e,t){"string"==typeof e?Object.entries(this.pixelStorage).forEach((([r,n])=>{n.isError||(n.isLoaded?(n.sendEventFunc(e,t),ae(`Send ${r} goal ${e}`)):n.eventsQueued.push({goal:e,params:t}))})):ae("Wrong goal",e)}sendGoogleTagMangerEvent(e,t){var r;"string"==typeof e&&(null==(r=this.pixelStorage.google_tag_manger.pixelFrame.contentWindow)||r.postMessage({goal:e,params:t},this.pixelsOrigin))}sendAllEventFromQueue(e){const t=this.pixelStorage[e];t&&!t.isError&&t.isLoaded&&(t.eventsQueued.forEach((e=>t.sendEventFunc(e.goal,e.params))),t.eventsQueued=[])}initPixelIframe(e,t,r){e.src=t,e.style.display="none",e.onload=()=>{this.pixelStorage[r].isLoaded=!0,this.pixelStorage[r].isError=!1,this.sendAllEventFromQueue(r)},e.onerror=()=>{this.pixelStorage[r].isError=!0,this.pixelStorage[r].isLoaded=!1,this.pixelStorage[r].eventsQueued=[]},document.body.appendChild(e)}createPixelIframe(e,t,r){var n;const o=document.createElement("iframe"),a=oe((null==(n=window.appData.abt)?void 0:n.flags)||{},Q)||6e4;this.pixelStorage[t]={eventsQueued:[],isError:!1,isLoaded:!1,pixelFrame:o,sendEventFunc:r},J((()=>{this.initPixelIframe(o,e,t)}),a)}},ie=se;var ce=r(540);const le={playhop:92757394,yandex:49035923},de="undefined"!=typeof window;function ue(e,t,r){"reachGoal"===e&&function(...e){window.dataLayer||(window.dataLayer=[]),window.dataLayer.push(arguments)}("event",t,r)}function pe(e,t,r={},n){var o;"string"==typeof t&&(ue(e,t,r),ie.sendEvent(t,r),n&&(null==(o=window.clickdaemonLog)||o.call(window,t,r)))}function he(e,t,r,...n){const{withClickDaemon:o}=r;let a={},s={};n[0]&&"object"==typeof n[0]?[a]=n:n[1]&&"object"==typeof n[1]&&([,a]=n,[,s]=n),a.appVersion||(a.appVersion="build1702033910",s.appVersion="build1702033910"),!a.service&&window.clientMetadata.serviceName&&(a.service=window.clientMetadata.serviceName),!a.platform_id&&window.clientMetadata.platform&&(a.platform_id=window.clientMetadata.platform),window.ym?(window.ym(e,t,...n),pe(t,n[0],s,o)):window[`yaCounter${e}`]?(window[`yaCounter${e}`][t](...n),pe(t,n[0],s,o)):me("Cannot send metrika")}function me(e){var r,n;const o=new Error(e);(0,ce.u)()?(0,t.H)({block:a.W.METRIKA,level:null==(n=null==(r=window.Ya)?void 0:r.Rum)?void 0:n.ERROR_LEVEL.WARN},o):console.error(o)}function ge(e){return e===p.U_6.PLAYHOP?le.playhop:le.yandex}const fe=K((function(){me("Metrika's callbacks array is overflowed")}));function ye(e,t,...r){const{shouldMetrikaWork:n=!0}=t;if(de&&n){const{metrika:{counterId:n}}=window.appData||window.gameTokAppData;if(window.ym||window[`yaCounter${n}`])he(n,e,t,...r);else{Array.isArray(window.yandex_metrika_callbacks2)||(window.yandex_metrika_callbacks2=[]);const o=window.yandex_metrika_callbacks2;o.length<500?o.push((()=>{he(n,e,t,...r)})):fe()}}return Promise.resolve()}ye.bind(null,"hit"),ye.bind(null,"params"),ye.bind(null,"reachGoal");const we=function(e,t,r={}){var n,o,a,s;try{const i={borrowParams:{adv:{sdk:{[t]:{[e]:!0,isFirstTryOpen:"tryOpen"===e&&r.isFirstTryOpen,appVersion:window.APP_VERSION}}}}},c=new Image,l=(null==(o=null==(n=window.YandexGamesSDKEnvironment)?void 0:n.i18n)?void 0:o.tld)||"ru",d=ge(null==(s=null==(a=window.YandexGamesSDKEnvironment)?void 0:a.data)?void 0:s.secondDomain);c.src=`https://mc.yandex.${l}/watch/${d}?page-url=${encodeURIComponent(window.location.href)}&page-ref=${encodeURIComponent(document.referrer)}&charset=utf-8&site-info=${encodeURIComponent(JSON.stringify(i))}`}catch(e){}};Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;I("AdvStickyBanner",E.Adv),p.Go0.PLAYHOP,p.Go0.YANDEX,p.Go0.PLAYHOP,p.Go0.YANDEX,p.Go0.PLAYHOP,p.Go0.YANDEX,p.Go0.PLAYHOP,p.Go0.YANDEX,p.Go0.PLAYHOP,p.Go0.YANDEX;var ve=(e=>(e.ADV_IS_NOT_CONNECTED="ADV_IS_NOT_CONNECTED",e.UNKNOWN="UNKNOWN",e))(ve||{});const be="1"===(0,H.VB)(p.x2l),Ee=((0,H.VB)(p.p4F),(0,H.VB)(p.x2l));"undefined"!=typeof window&&Ee&&(0,H.VB)(p.dsH);const Pe=I("AdvManager",E.Adv);function _e(e,t){return"function"==typeof e[t]?function(e,t="",r){return(...n)=>{try{return e(...n)}catch(e){(0,c.fF)(e,{prefix:t}),r&&r(e)}}}(e[t],`Error in callback ${t}: `):()=>{}}class Oe{constructor(e){var t;this.isFirstTryOpenFullscreenAdv=!0,this.isFirstTryOpenRewardedAdv=!0,this.onAdvDebugManagerExternalMessage=e=>{const{action:t}=e.data;switch(t){case"debug-action-showFullscreenAdv":this.showFullscreenAdvDebug(t);break;case"debug-action-showRewardedVideo":this.showRewardedVideoDebug(t);break;case"debug-action-switchStickyBanners":this.switchStickyBannersDebug(t)}},this.onAdvManagerExternalMessage=e=>{var t,r,n,o,a,s,i,l,d,u,p,h,m,g,f;const{action:y,data:w}=e.data;switch(y){case"adv-callback-open":null==(r=(t=this.callbacks).onOpen)||r.call(t);break;case"adv-callback-close":this.callOnAdvClose(w.wasShown);break;case"adv-callback-error":this.callOnAdvClose(!1);try{if("string"!=typeof(null==(n=null==w?void 0:w.error)?void 0:n.message)){const e=new Error("Undefined error message");try{e.additional=JSON.stringify(w)}catch(t){e.additional="undefined"}(0,c.fF)(e)}}catch(e){}null==(a=(o=this.callbacks).onError)||a.call(o,new Error(w.error.message,{cause:w.error}));break;case"adv-callback-offline":this.callOnAdvClose(!1),null==(i=(s=this.callbacks).onOffline)||i.call(s);break;case"rewarded-video-callback-open":null==(d=(l=this.callbacks).onOpen)||d.call(l);break;case"rewarded-video-callback-rewarded":null==(p=(u=this.callbacks).onRewarded)||p.call(u);break;case"rewarded-video-callback-close":null==(m=(h=this.callbacks).onClose)||m.call(h);break;case"rewarded-video-callback-error":null==(f=(g=this.callbacks).onError)||f.call(g,new Error(w.error.message,{cause:w.error}));break;case"set-disabled-state":Pe('On "set-disabled-state" event',e.data,w.value),this.setDisabledState(w.value)}},this.adv=e.adv||{},this.checkDeprecatedOnAdvCloseUsage(),(null==(t=window.YandexGamesSDKEnvironment)?void 0:t.isWorldWide)?this.setDisabledState(!0):be&&B(),Object.defineProperty(this,"callbacks",{enumerable:!1,writable:!0}),Object.defineProperty(this.adv,"onAdvClose",{enumerable:!1,writable:!0}),l.Z.onExternalMessage("adv-manager",this.onAdvManagerExternalMessage),l.Z.onExternalMessage("adv-debug-manager",this.onAdvDebugManagerExternalMessage),this.updateDisabledState()}checkDeprecatedOnAdvCloseUsage(){"onAdvClose"in this.adv&&(0,c.Ts)(new Error('Deprecated usage "onAdvClose". Please, use `ysdk.adv.method({callbacks})` https://yandex.ru/dev/games/doc/sdk/sdk-adv'))}showFullscreenAdvDebug(e){this.showFullscreenAdv({callbacks:{onClose:t=>Pe(`${e} onClose, wasShown = ${t}`),onError:t=>Pe(`${e} onError, error =`,t),onOffline:()=>Pe(`${e} onOffline`),onOpen:()=>Pe(`${e} onOpen`)}})}showRewardedVideoDebug(e){this.showRewardedVideo({callbacks:{onClose:()=>Pe(`${e} onClose`),onError:t=>Pe(`${e} onError, error =`,t),onOpen:()=>Pe(`${e} onOpen`),onRewarded:()=>Pe(`${e} onRewarded`)}})}switchStickyBannersDebug(e){this.getBannerAdvStatus().then((({stickyAdvIsShowing:t})=>{t?this.hideBannerAdv().then((({stickyAdvIsShowing:t})=>{Pe(`${e} hideBannerAdv, stickyAdvIsShowing = ${t}`)})):this.showBannerAdv().then((({reason:t,stickyAdvIsShowing:r})=>{Pe(`${e} hideBannerAdv, stickyAdvIsShowing = ${r}, reason = ${t}`)}))}))}updateDisabledState(){l.Z.postToParent({type:"adv-manager",action:"get-disabled-state"}).then((({data:e})=>{this.setDisabledState(e.value)})).catch(console.warn)}setDisabledState(e){Pe("setDisabledState",e),e?W():Z&&(Z=!1)}showFullscreenAdv({callbacks:e={}}={}){we("tryOpen","fullscreen",{isFirstTryOpen:this.isFirstTryOpenFullscreenAdv}),this.isFirstTryOpenFullscreenAdv=!1;const t=L("AdvManager.showFullscreenAdv");l.Z.postToParent({type:"adv-manager",action:"adv-show-fullscreen",timeout:10*f}).then((({data:{error:t}})=>{if(t){if((0,u.mv)()&&t.message.includes("often than once per"))throw t;(0,c.fF)(t),_e(e,"onClose")(!1),this.callDeprecatedOnClose(!1)}else this.setCallbacks(e,["onClose","onOpen","onError","onOffline"])})).catch((t=>{(0,c.fF)(t),_e(e,"onError")(t),_e(e,"onClose")(!1),this.callDeprecatedOnClose(!1)})).finally((()=>{t()}))}showRewardedVideo({callbacks:e={}}={}){we("tryOpen","rewarded",{isFirstTryOpen:this.isFirstTryOpenRewardedAdv}),this.isFirstTryOpenRewardedAdv=!1;const t=L("AdvManager.showRewardedVideo");l.Z.postToParent({type:"adv-manager",action:"adv-show-rewarded-video",timeout:10*f}).then((({data:{error:t}})=>{if(t)throw t;this.setCallbacks(e,["onOpen","onRewarded","onClose","onError"])})).catch((t=>{(0,c.fF)(t),_e(e,"onError")(t),_e(e,"onClose")(!1)})).finally((()=>{t()}))}showBannerAdv(){return new Promise((e=>{const t=L("AdvManager.showBannerAdv");l.Z.postToParent({type:"adv-manager",action:"adv-show-sticky-banner",timeout:3*f}).then((({data:t})=>{e(t)})).catch((t=>{(0,c.fF)(t),e({reason:ve.UNKNOWN,stickyAdvIsShowing:!1})})).finally((()=>{t()}))}))}hideBannerAdv(){return new Promise((e=>{const t=L("AdvManager.hideBannerAdv");l.Z.postToParent({type:"adv-manager",action:"adv-hide-sticky-banner",timeout:3*f}).then((({data:t})=>{e(t)})).catch((t=>{(0,c.fF)(t),e({stickyAdvIsShowing:!1})})).finally((()=>{t()}))}))}getBannerAdvStatus(){return new Promise((e=>{const t=L("AdvManager.getBannerAdvStatus");l.Z.postToParent({type:"adv-manager",action:"adv-status-sticky-banner",timeout:3*f}).then((({data:t})=>{e(t)})).catch((t=>{(0,c.fF)(t),e({reason:ve.UNKNOWN,stickyAdvIsShowing:!1})})).finally((()=>{t()}))}))}setCallbacks(e,t){this.callbacks={},t.forEach((t=>{this.callbacks[t]=_e(e,t)}))}callOnAdvClose(e=!1){var t,r;this.callDeprecatedOnClose(e),null==(r=(t=this.callbacks).onClose)||r.call(t,e)}callDeprecatedOnClose(e=!1){if("function"==typeof this.adv.onAdvClose)try{this.adv.onAdvClose(e)}catch(e){(0,c.Ts)(e)}}}const Se=new class{openAuthDialog(){const e=L("AuthManagerPublic.openAuthDialog",2*y),t=l.Z.postToParent({type:"auth",action:"auth-dialog-open",data:{initializer:"auth-manager-public"}});return t.finally((()=>{e()})),t}};var Ae=r(422),Ie=r(399);const xe=e=>{const t=new URL(e);class r{constructor(){this.items=[]}contains(e){return this.items.includes(e)}item(e){var t;return null!=(t=this.items[e])?t:null}get length(){return this.items.length}*[Symbol.iterator](){}}return{location:{ancestorOrigins:new r,hash:t.hash,host:t.host,hostname:t.hostname,href:t.href,origin:t.origin,pathname:t.pathname,port:t.port,protocol:t.protocol,search:t.search,assign:()=>{},reload:()=>{},replace:()=>{}}}},Te="undefined"!=typeof window?window:xe("https://yandex.ru/games/app/1");var ke,De;const Re=I("src/sdk/utils/env",E.Dev),Ce="undefined"!=typeof window&&((null==(ke=window.appData)?void 0:ke.env)||(null==(De=window.gameTokAppData)?void 0:De.env))||void 0,Le=Ce?Ce.NODE_ENV:"production",Ne="production"===Le||"stress"===Le;Re("IS_PROD",Ne),Re("NODE_ENV",Le);const Me=(0,Ie.Z)(Te.location),je=(Ne||parseInt(Me.test_uid,10),Ne||Me.test_email,Ne||Me.test_oauth,Me.origin||void 0),$e=je||Te.location.origin,Ge=je?je.match(p.SBp):Boolean(Te.location.origin.match(p.SBp)),Fe=Te.location.hostname.endsWith("ya.ru");const Ye=Ge?p.U_6.PLAYHOP:Fe?p.U_6.YA:p.U_6.YANDEX,Ue=($e.match(new RegExp(`[./]${Ye}\\.([a-z.]+)$`))||["","ru"])[1],Ze=(Ce?Ce.SDK_BACKEND_URL:"https://games-sdk.yandex.%TLD%/games/api/sdk/v1")||"",We=(Ce?Ce.PLAYHOP_SDK_BACKEND_URL:"https://games-sdk.playhop.%TLD%/games/api/sdk/v1")||"",Be=Ge?m(We,Ue):m(Ze,Ue,Te.location.host);Re("BACKEND_SDK_URL",Be);Ce&&Ce.OAUTH_CLIENT_ID,Ce&&Ce.SDK_PASSPORT_PREFIX;let Ke;Ke=r(510).Z;const He=Ke;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;p.xYt.L,p.xYt.CATEGORIZED_NEW_L,p.xYt.RECOMMENDED_NEW,p.xYt.ADAPTIVE_RECOMMENDED_NEW,p.xYt.PROFILE_RECENT_GAMES,p.xYt.PREMIUM_BIG,p.xYt.TV;var Ve=(e=>(e.BIG="big",e.ISLANDS_75="islands-75",e.ISLANDS_200="islands-200",e.ISLANDS_MIDDLE="islands-middle",e.ISLANDS_RETINA_MEDIUM="islands-retina-medium",e.ISLANDS_RETINA_SMALL="islands-retina-small",e.NORMAL="normal",e))(Ve||{});const ze="0/0-0";var qe=r(751);function Je(e,t,r){var n,o;if(!e)return;let a=function(e,t,r){let n;try{let t=new URL(e);n=qe.parse((r?t.hash:t.search).slice(1))}catch(e){return}if(void 0===n)return;let o=null==n?void 0:n[t];return o?Array.isArray(o)?o[0]:o:void 0}(e,"sdk_url",t);if(void 0===a)return;const s=void 0!==r?r.SDK_CUSTOM_DOMAINS:process.env.SDK_CUSTOM_DOMAINS;if(!s)return;let i;try{i=JSON.parse(s)}catch(e){return}if(void 0===i)return;return null!=(o=null==(n=null==i?void 0:i[a])?void 0:n.apiDomain)?o:void 0}function Xe(e){var t;let r=new URL(e);if(null==(t=null==window?void 0:window.appData)?void 0:t.env){let e=Je(window.location.href,!0,window.appData.env);if(e)return r.hostname=e,r.href}return e}const Qe={small:Ve.ISLANDS_RETINA_SMALL,medium:Ve.ISLANDS_RETINA_MEDIUM,large:Ve.ISLANDS_200},et={small:Ve.ISLANDS_200,medium:Ve.ISLANDS_200,large:Ve.BIG},tt=`${Be}/player`;class rt{constructor(e){this._personalInfo=e}getID(){return(0,c.Ts)(new Error("Player.getID() is deprecated. Please, use Player.getUniqueID().\nhttps://yandex.ru/dev/games/doc/dg/sdk/sdk-player.html#sdk-player__profile-data")),He.sendOnceDeprecatedUsage("Player.getID"),this._personalInfo.id}getUniqueID(){return this._personalInfo.uniqueID}getName(){return this._personalInfo.publicName}getMode(){var e;return V()?"":null!=(e=this._personalInfo.mode)?e:""}getPhoto(e="medium"){const t=Qe[e];if(!t)throw new Error(`Unknown size value ('${e}')`);return this._personalInfo.avatarIdHash?`${Xe(tt)}/avatar/${this._personalInfo.avatarIdHash}/${t}`:`https://avatars.mds.yandex.net/get-yapic/${ze}/${t}`}hasPremium(){var e;return null!=(e=this._personalInfo.hasPremium)&&e}}var nt=Object.defineProperty,ot=Object.getOwnPropertySymbols,at=Object.prototype.hasOwnProperty,st=Object.prototype.propertyIsEnumerable,it=(e,t,r)=>t in e?nt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ct=(e,t)=>{for(var r in t||(t={}))at.call(t,r)&&it(e,r,t[r]);if(ot)for(var r of ot(t))st.call(t,r)&&it(e,r,t[r]);return e};const lt=(e,t)=>l.Z.postToParent({type:"telegram",data:{playdeck:ct({method:e},t)}}),dt="tgData",ut=f,pt=()=>(lt("getData",{key:dt}),new Promise(((e,t)=>{function r(n){var o;if(!(e=>{var t,r,n;return"getData"===(null==(n=null==(r=null==(t=e.data)?void 0:t.data)?void 0:r.playdeck)?void 0:n.method)})(n))return;l.Z.offExternalMessage("telegram",r);const a=(null==(o=n.data.data.playdeck.value)?void 0:o.data)||"{}";if("string"==typeof a)try{e(JSON.parse(a))}catch(e){const r=new Error("Error parsing game data from telegram");r.additional={originalError:e},(0,c.fF)(r,{prefix:"telegram"}),t({})}else e(a)}l.Z.onExternalMessage("telegram",r),setTimeout((()=>{l.Z.offExternalMessage("telegram",r),t()}),ut)})));function ht(e,t){let r,n;return function(...o){const a=o,s=this;return r||(r=!0,setTimeout((()=>r=!1),t),n=e.apply(s,a)),n}}var mt=r(160);function gt(e,t="",r={}){Object.keys(r).forEach((e=>{void 0===r[e]&&delete r[e]}));const n=(0,mt.Z)({url:`${e}${t}`,params:r});return(0,u.$g)(n)}function ft(e){const{api:t,authRequired:r,path:n,params:o,timeout:a}=e;return new Promise(((e,s)=>{const i=gt(t,n,o);if(!i)return void s(new Error("Can not create URL"));l.Z.postToParent({type:"fetch",data:{authRequired:r,options:{credentials:"include",referrerPolicy:"no-referrer-when-downgrade"},timeout:a,url:i}}).then((({data:{result:t}})=>{e(t)})).catch(s)}))}function yt(e){const{api:t,authRequired:r,data:n,params:o,path:a,timeout:s}=e;return new Promise(((e,i)=>{const c=gt(t,a,o);if(!c)return void i(new Error("Can not create URL"));const d={body:JSON.stringify(n),credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",referrerPolicy:"no-referrer-when-downgrade"};l.Z.postToParent({type:"fetch",data:{authRequired:r,options:d,timeout:s,url:c}}).then((({data:{result:t}})=>{e(t)})).catch(i)}))}const wt={FULLSCREEN:"R-I-320442-1",REWARDED_VIDEO:"R-I-328933-4",STICKY_MOBILE_LANDSCAPE_UPPER:"R-I-328933-35",STICKY_MOBILE_UPPER:"R-I-328933-34",STICKY_DESKTOP_RIGHT:"R-I-328933-33"};function vt(){var e,t;if("object"!=typeof window)return 1;const r=(null==(e=null==window?void 0:window.appData)?void 0:e.networkThrottlingRatio)||1;return(null==(t=null==window?void 0:window.appData)?void 0:t.isWorldWide)?1.5*r:1*r}const bt=`${Be}/leaderboard`,Et=10*f,Pt=()=>Et*vt(),_t=(e,t={},r)=>ft({api:Xe(bt),timeout:Pt(),path:e,params:t,authRequired:Boolean(null==r?void 0:r.authRequired)});var Ot=Object.defineProperty,St=Object.defineProperties,At=Object.getOwnPropertyDescriptors,It=Object.getOwnPropertySymbols,xt=Object.prototype.hasOwnProperty,Tt=Object.prototype.propertyIsEnumerable,kt=(e,t,r)=>t in e?Ot(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const Dt=f,Rt=ht(((e,t,r={})=>yt({api:Xe(bt),timeout:Pt(),authRequired:!0,path:e,data:t,params:r})),Dt);class Ct{constructor(){this._appId=(0,u.rh)()}getLeaderboardDescription(e){const t=L("Leaderboards.getLeaderboardDescription"),r=_t("/descr",{"app-id":this._appId,name:e});return r.finally((()=>{t()})),r}getLeaderboardStat(e){const t=L("Leaderboards.getLeaderboardStat"),r=_t("/stat",{"app-id":this._appId,name:e});return r.finally((()=>{t()})),r}transformLeaderboardEntry(e){const{avatarIdHash:t,lang:r,publicName:n,scopePermissions:o,uniqueID:a}=e.player,s=`${tt}/avatar/${t}`;return i=((e,t)=>{for(var r in t||(t={}))xt.call(t,r)&&kt(e,r,t[r]);if(It)for(var r of It(t))Tt.call(t,r)&&kt(e,r,t[r]);return e})({},e),St(i,At({player:{getAvatarSrc:(e="medium")=>(Qe[e]||(e="medium"),`${s}/${Qe[e]}`),getAvatarSrcSet:(e="medium")=>(Qe[e]||(e="medium"),`${s}/${Qe[e]} 1x, ${s}/${et[e]} 2x`),lang:r,publicName:n,scopePermissions:o,uniqueID:a}}));var i}transformLeaderboardEntries(e){return e.map(this.transformLeaderboardEntry)}getLeaderboardEntries(e,t){const{includeUser:r=!1,quantityAround:n=5,quantityTop:o=5}=t||{},a=L("Leaderboards.getLeaderboardEntries"),s=_t((0,u.H8)("/entries"),{"app-id":this._appId,include_user:r,name:e,quantity_around:n,quantity_top:o},{authRequired:r}).then((e=>{const{entries:t,leaderboard:r,ranges:n,userRank:o}=e;return{entries:this.transformLeaderboardEntries(t),leaderboard:r,ranges:n,userRank:o}}));return s.finally((()=>{a()})),s}getLeaderboardPlayerEntry(e){if(V())throw new Ae.Z({code:"LEADERBOARD_PLAYER_NOT_PRESENT",httpStatus:204,message:"Player is not present in leaderboard"});return _t((0,u.H8)("/player-entry"),{"app-id":this._appId,name:e},{authRequired:!0}).then((e=>{if(!e)throw new Ae.Z({code:"LEADERBOARD_PLAYER_NOT_PRESENT",httpStatus:204,message:"Player is not present in leaderboard"});return this.transformLeaderboardEntry(e)}))}setLeaderboardScore(e,t,r){if(V())return l.Z.postToParent({type:"gametok-manager",action:"new-igroyal-score",data:{score:t}}),new Promise((e=>e(!0)));lt("setScore",{value:t});const n={"app-id":this._appId,name:e,score:t};return"viber"===(0,H.VB)("utm_source")&&(n.fromViber=!0),this.lastTimeLeaderboardWasSend&&!this.canSetLeaderboardScoreByTime()?Promise.reject("The request to setLeaderboardScore can be sent no more than once per second"):(r&&(n.extraData=r),this.lastTimeLeaderboardWasSend=Date.now(),Rt("/score",n))}canSetLeaderboardScoreByTime(){return Date.now()-this.lastTimeLeaderboardWasSend>Dt}}const Lt=()=>{const e=new Ct;return Promise.resolve(e)};var Nt=r(538);const Mt="companyName",jt="serviceName",$t={[p.U_6.PLAYHOP]:{[Mt]:{ru:"Playhop",en:"Playhop"},[jt]:{ru:"Playhop",en:"Playhop"}},[p.U_6.YANDEX]:{[Mt]:{ru:"",en:"Yandex"},[jt]:{ru:"",en:"Games"}}};$t[p.U_6.YA]=$t[p.U_6.YANDEX];const Gt="ru";function Ft(e,t=Gt,r=""){if(e){if("string"==typeof e)return e;if(t in e)return e[t]||r;if(!(e=>!e||g.includes(e))(t)&&"en"in e)return e.en||r;if(Gt in e)return e[Gt]||r}return r}const Yt="//yastatic.net/s3/games-static/static-data/images/payments/sdk";let Ut=function(){Ut=()=>{},He.params({borrowParams:{payments:{appId:(0,u.rh)(),productCurrencyCodeGet:!0}}})};class Zt{constructor(e){this._productData=e}get id(){return this._productData.id}get title(){return Ft(this._productData.title)}get description(){return Ft(this._productData.description)}get imageURI(){const{image:e}=this._productData;return e&&"object"==typeof e&&"url_prefix"in e?/\.(png|jpg|svg)$/.test(String(e.url_prefix))?e.url_prefix:`${e.url_prefix}/default256x256`:"https://yastatic.net/s3/games-static/static-data/images/payments/default-product-image.png"}get price(){const{price:e}=this._productData;return`${e}${this.priceCurrencyCode}`}get priceValue(){return String(this._productData.price)}get priceCurrencyCode(){var e;return Ut(),null==(e=window.YandexGamesSDKEnvironment)?void 0:e.moneyCodeSymbol}getPriceCurrencyImage(e="small"){if("svg"===e)return`${Yt}/currency-icon-m.svg`;let t="s";switch(e){case"medium":case"small":t=e.charAt(0);break;default:console.warn(`Unknown size value ('${e}')`)}const r=window.devicePixelRatio>=2;return`${Yt}/currency-icon-${t}${r?"@2x":""}.png`}toJSON(){return{id:this.id,title:this.title,description:this.description,imageURI:this.imageURI,price:this.price,priceValue:this.priceValue,priceCurrencyCode:this.priceCurrencyCode}}}class Wt{constructor(e){"purchaseTime"in e||(e.purchaseTime=0),this.purchaseData=e}get productID(){return this.purchaseData.productID}get purchaseTime(){return this.purchaseData.purchaseTime}get purchaseToken(){return this.purchaseData.purchaseToken}get developerPayload(){return this.purchaseData.developerPayload}toJSON(){return{productID:this.productID,purchaseTime:this.purchaseTime,purchaseToken:this.purchaseToken,developerPayload:this.developerPayload}}}function Bt(e){return function(e){for(var t,r="",n=e.length,o=0;o<n;o++)t=e[o],r+=String.fromCharCode(t>251&&t<254&&o+5<n?1073741824*(t-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:t>247&&t<252&&o+4<n?(t-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:t>239&&t<248&&o+3<n?(t-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:t>223&&t<240&&o+2<n?(t-224<<12)+(e[++o]-128<<6)+e[++o]-128:t>191&&t<224&&o+1<n?(t-192<<6)+e[++o]-128:t);return r}(function(e,t){for(var r,n,o,a=e.replace(/[^A-Za-z0-9\+\/]/g,""),s=a.length,i=t?Math.ceil((3*s+1>>>2)/t)*t:3*s+1>>>2,c=new Uint8Array(i),l=0,d=0,u=0;u<s;u++)if(n=3&u,l|=((o=a.charCodeAt(u))>64&&o<91?o-65:o>96&&o<123?o-71:o>47&&o<58?o+4:43===o?62:47===o?63:0)<<18-6*n,3===n||s-u==1){for(r=0;r<3&&d<i;r++,d++)c[d]=l>>>(16>>>r&24)&255;l=0}return c}(e))}function Kt(e,t){t&&Object.defineProperty(e,"signature",{enumerable:!1,configurable:!1,get:()=>t})}const Ht=I("Payment",E.Dev);class Vt{constructor(e={}){this._config=e,this.___test1212()}getCatalog(){return new Promise(((e,t)=>{const r=L("Payments.getCatalog");l.Z.postToParent({type:"payments",action:"get-catalog",data:{lang:this._config.lang}}).then((({data:t})=>{Ht("get-catalog result",t),e(t.products.map((e=>new Zt(e))))})).catch((e=>{t(e)})).finally((()=>{r()}))}))}purchase(e){"object"!=typeof e&&(e={id:e,developerPayload:""});const{developerPayload:t}=e;if(t){if("string"!=typeof t)return Promise.reject(new Error("developerPayload must be a string"))}else e.developerPayload="";return new Promise(((t,r)=>{l.Z.postToParent({type:"payments",action:"purchase-start",data:{paymentsConfig:this._config,purchaseConfig:e}}).then((({data:{data:e,signature:r}})=>{Ht("purchase-start then");const n=new Wt({productID:e.product.id,purchaseToken:e.token,developerPayload:e.developerPayload});Kt(n,r),t(n)})).catch((e=>{Ht("purchase-start catch"),r(e)}))}))}getPurchases(){return new Promise(((e,t)=>{const r=L("Payments.getPurchases");l.Z.postToParent({type:"payments",action:"get-purchases",data:{paymentsConfig:this._config}}).then((({data:{data:t,signature:r}})=>{Ht("getPurchases callback",t);const n=t.map((e=>new Wt({productID:e.product.id,purchaseToken:e.token,developerPayload:e.developerPayload})));Kt(n,r),e(n)})).catch((e=>{t(e)})).finally((()=>{r()}))}))}consumePurchase(e){return new Promise(((t,r)=>{const n=L("Payments.consumePurchase");l.Z.postToParent({type:"payments",action:"purchase-consume",data:{token:e}}).then((({data:e})=>{if(console.info("consumePurchase data"),console.info(e),!e||!e.token)throw new Nt.Z({code:"CANNOT_CONSUME_PURCHASE",message:"Can not consume purchase."});t(!0)})).catch((e=>{r(e)})).finally((()=>{n()}))}))}___test1212(){var e,t,r;if("96458"!==(null==(e=window.YandexGamesSDKEnvironment)?void 0:e.app.id))return;if(!0!==(null==(r=null==(t=window.YandexGamesSDKEnvironment)?void 0:t.request.experiments)?void 0:r.test1212Payments))return;const n="position: fixed; left: 15px; padding: 0.3em; background: #fff; border: 1px solid #000; border-radius: 5px;";let o=document.createElement("div");o.setAttribute("id","payElement1212-noads"),o.setAttribute("style",`${n} top: 5px;`),o.textContent='purchase("noads")',o.onclick=()=>this.___test1212Purchase("noads"),document.body.appendChild(o),o=document.createElement("div"),o.setAttribute("id","payElement1212-3x3antiblock"),o.setAttribute("style",`${n} top: 40px;`),o.textContent='purchase("3x3antiblock")',o.onclick=()=>this.___test1212Purchase("3x3antiblock"),document.body.appendChild(o)}___test1212Purchase(e){function t(t){const r=document.getElementById(`payElement1212-${e}`);r&&(r.style.backgroundColor=t?"#0f0":"#f00")}this.purchase({id:e,developerPayload:""}).then((()=>t(!0))).catch((e=>{t(!1),(0,c.fF)(e)}))}}const zt=function(e={}){const t=new Vt(e);return new Promise(((e,r)=>{t.getCatalog().then((()=>e(t))).catch(r)}))},qt={APP_VERSION:"",app:{id:""},browser:{lang:"ru"},clid:void 0,i18n:{lang:"ru",tld:"ru"},isStickyBannerEnabled:!1,isWorldWide:!1,isYandexApp:!1,isTelegram:!1,moneyCodeSymbol:p.NAu.HOP,params:{},request:{},serviceName:p.Go0.YANDEX};let Jt=()=>(window.YandexGamesSDKEnvironment||(0,c.fF)(new Error("SDK environment: `window.YandexGamesSDKEnvironment` is undefined")),Jt=()=>window.YandexGamesSDKEnvironment||qt,Jt());const Xt={get app(){return Jt().app},get browser(){return{lang:Jt().i18n.lang}},get data(){return Jt().data||{}},get i18n(){return Jt().i18n},get payload(){return Jt().params.payload},get isTelegram(){return Jt().isTelegram}},Qt=`${Be}/player`,er=5*f,tr=()=>er*vt(),rr=(e,t,r={})=>yt({api:Xe(Qt),timeout:tr(),path:e,data:t,params:r}),nr=204800;function or(e){try{return JSON.stringify(e)}catch(e){return(0,c.fF)(e),`${Date.now()}.${Math.random()}`}}class ar{constructor(e){this._playerId=e,this._dataHash=null,this._timestamp=0}isSamePlayer(e){return e===this._playerId}set dataHash(e){this._dataHash=e?or(e):null}validate(e){const t=or(e);return function(e){try{return(new TextEncoder).encode(e).length}catch(t){return function(e){let t=e.length;for(let r=e.length-1;r>=0;r--){let n=e.charCodeAt(r);n>127&&n<=2047?t++:n>2047&&n<=65535&&(t+=2),n>=56320&&n<=57343&&r--}return t}(e)}}(t)>nr?{error:new Error("The data is too large (bigger then 204800 bytes)."),reject:!0}:this._dataHash===t?{error:new Error("The data does not differ from the previous ones."),reject:!1}:{}}getWaitTime(){let e=200;const t=Math.abs(Date.now()-this._timestamp);return t<3e3&&(e=Math.max(200,3e3-t)),e}set timestamp(e){this._timestamp=e}}const sr=I("Player",E.Dev);function ir(e){const{data:t,signature:r}=function(e){if("signature"in e){const{signature:t}=e;if("string"==typeof t){const{data:e}=JSON.parse(Bt(t.split(".")[1]));return{data:e,signature:t}}(0,c.fF)(new Error("response.signature is not a string"))}return{data:e}}(e);return Kt(t,r),t}function cr(e,t){if(void 0===t)return e;if(!Array.isArray(t))throw new Error("`keys` must be an Array");if(-1!==t.indexOf("signature"))throw new Error('`keys` must not contains "signature" key');const r={};return t.forEach((t=>{t in e&&(r[t]=e[t])})),r}function lr(e){return!(!e||"object"!=typeof e)&&Object.values(e).every((e=>"number"==typeof e&&!isNaN(e)))}let dr,ur,pr,hr;l.Z.onExternalMessage("auth",(e=>{if("changed"===e.data.action&&pr){sr("Call onLogoutCallback()");try{pr()}catch(e){console.error()}pr=void 0}}));class mr extends rt{constructor(e,t){super(e),this.dataPromise=null,this.getApiPromise=()=>new Promise(((e,t)=>{this._fetchData("/data").then((t=>{this.data=t,e(t)})).catch((e=>{this.dataPromise=null,t(e)}))})),this.getDataPromise=()=>void 0!==this.data?Promise.resolve(this.data):Xt.isTelegram?pt().catch((()=>this._fetchData("/data"))):this.getApiPromise(),this.config=t,ur&&ur.isSamePlayer(this.getUniqueID())||(ur=new ar(this.getUniqueID()))}onLogout(e){sr("Set onLogout callback"),pr=e}getIDsPerGame(){return this._fetchData("-ids-per-game")}getData(e){return V()?Promise.resolve({}):(this.dataPromise=this.getDataPromise(),this.dataPromise.then((t=>cr(t,e))))}setData(e,t=!1){if(V())return new Promise((e=>e(!0)));var r;if(Xt.isTelegram&&(r=e,lt("setData",{key:dt,value:JSON.stringify(r)})),!function(e){return"object"==typeof e&&null!==e}(e))return Promise.reject(new Error("Data is not valid"));this.data=e;const n=function(e,t=!1){const r=ur.validate(e);return r.error?r.reject?Promise.reject(r.error):((0,c.Ts)(r.error),Promise.resolve(!0)):new Promise(((r,n)=>{dr&&window.clearTimeout(dr);let o=t?200:Math.max(200,ur.getWaitTime());ur.timestamp=Date.now(),dr=window.setTimeout((()=>{rr("/data",e).then((()=>{ur.dataHash=e,r(!0)})).catch((e=>{ur.timestamp=0,ur.dataHash=null,n(e)}))}),o)}))}(e,t);return t?n:Promise.resolve(!0)}getStats(e){return V()?new Promise((e=>e({}))):(void 0===this.statsPromise&&(this.statsPromise=new Promise(((e,t)=>{this._fetchData("/stats").then(e).catch(t).finally((()=>this.statsPromise=void 0))}))),this.statsPromise.then((t=>cr(t,e))))}setStats(e){return V()?new Promise((e=>e(!0))):lr(e)?rr("/stats",e):Promise.reject(new Error("Stats is not valid"))}incrementStats(e){return V()?new Promise((e=>e(!0))):lr(e)?this._postData("/stats/increment",e):Promise.reject(new Error("Increments is not valid"))}_fetchData(e){return((e,t={})=>ft({api:Xe(Qt),timeout:tr(),path:e,params:t}))((0,u.H8)(`${e}${this.config.signed?"-signed":""}`)).then(ir)}_postData(e,t){return rr(`${e}${this.config.signed?"-signed":""}`,t).then(ir)}}try{hr=window.localStorage}catch(e){}const gr=hr||function(){let e={};return{clear(){e={}},getItem:t=>e[t],key:t=>Object.keys(e)[t],removeItem(t){delete e[t]},setItem(t,r){e[t]=String(r)},get length(){return Object.keys(e).length}}}(),fr=/iPad|iPhone|iPod/.test(navigator.platform),yr=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),wr=fr||yr,vr=/app-[^.]+\.games\.s3\.yandex\.net$/.test(window.location.hostname),br=!vr&&wr,Er=K((()=>{(0,c.fF)(new Error("localStorage is broken on iOS/MacOS - https://developer.apple.com/forums/thread/109909\nPlease use YaGames.init().then(ysdk => ysdk.getStorage()).then(storage => storage.setItem('key', 'value'))"))})),Pr=class e{static setup(){br&&Object.defineProperty(window,"localStorage",{get:function(){return Er(),gr}}),wr&&vr&&e.setProxy()&&e.backup()}static load(){if(e.onloadPromise_)return e.onloadPromise_;const t=e.getCustomLocalStorage();return t?(e.onloadPromise_=new Promise((e=>{window.addEventListener("message",(({data:{type:r,action:n,data:o}})=>{if("local-storage"===r&&"get-all"===n){for(let e in o)t.setItem(e,String(o[e]));e(t)}})),window.parent.postMessage({type:"local-storage",action:"get-all",source:"YandexGamesSDK"},"*")})),e.onloadPromise_):Promise.resolve(gr)}static getCustomLocalStorage(){if("function"!=typeof Proxy)return null;return new Proxy({clear(){gr.clear.call(gr),l.Z.postToParent({type:"local-storage",action:"clear"})},getItem:e=>gr.getItem.call(gr,e),key:e=>gr.key.call(gr,e),get length(){return gr.length},removeItem(e){gr.removeItem.call(gr,e),l.Z.postToParent({type:"local-storage",action:"del",data:{key:e}})},setItem(e,t){gr.setItem.call(gr,e,String(t)),l.Z.postToParent({type:"local-storage",action:"set",data:{key:e,value:t}})}},{get:function(e,t){return t in e?e[t]:e.getItem(String(t))},set:function(e,t,r){return e.setItem(String(t),r),!0}})}static setProxy(){const t=e.getCustomLocalStorage();return!!t&&(Object.defineProperty(window,"localStorage",{get:function(){return t}}),!0)}static backup(){const e=Object.create(null);for(let t=0;t<gr.length;t++){const r=gr.key(t);r&&(e[r]=gr.getItem(r))}l.Z.postToParent({type:"local-storage",action:"backup",data:e})}};Pr.onloadPromise_=null;let _r=Pr;function Or(){return!wr&&hr?Promise.resolve(hr):_r.load()}function Sr(e){const t=typeof e;return null!=e&&("object"===t||"function"===t)}var Ar=Object.defineProperty,Ir=Object.getOwnPropertySymbols,xr=Object.prototype.hasOwnProperty,Tr=Object.prototype.propertyIsEnumerable,kr=(e,t,r)=>t in e?Ar(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Dr=(e,t)=>{for(var r in t||(t={}))xr.call(t,r)&&kr(e,r,t[r]);if(Ir)for(var r of Ir(t))Tr.call(t,r)&&kr(e,r,t[r]);return e};const Rr=I("captureAlert",E.Dev),Cr=250;function Lr(e){var t,r;if("DIV"===e.tagName&&e.getAttribute("style")&&!e.querySelector("div")&&!e.classList.length&&!e.id){const e="OK"===(null==(t=document.querySelector("button"))?void 0:t.textContent)&&(null==(r=document.querySelector("span"))?void 0:r.textContent);e&&(Rr(`popup message = ${e}`),l.Z.postToParent({type:"game-call-alert",data:{message:e.substring(0,Cr),popup:!0}}))}}function Nr(){const e="createUnityInstance"in window||"UnityLoader"in window;if(Rr("captureUnityAlert isUnity",e),!e)return;if(document.querySelectorAll("div[style]:not([id]):not([class])").forEach(Lr),"undefined"!=typeof MutationObserver){const e=new MutationObserver((e=>{e.forEach((e=>{"childList"===e.type&&setTimeout((()=>{Array.from(e.addedNodes).forEach(Lr)}),0)}))}));e.observe(document.body,{childList:!0,subtree:!0}),window.addEventListener("unload",(()=>{e.disconnect()}))}}const Mr=new class{writeText(e){try{e=String(e)}catch(e){return Promise.reject(new Error("Error while stringified provided value"))}return new Promise(((t,r)=>{const n=L("ClipboardPublic.writeText");l.Z.postToParent({type:"clipboard",action:"write-text",data:{text:e}}).then((()=>t(void 0))).catch(r).finally((()=>{n()}))}))}};class jr{constructor(e="desktop"){this._type=e}get type(){return this._type}isMobile(){return"mobile"===this.type}isTablet(){return"tablet"===this.type}isDesktop(){return"desktop"===this.type}isTV(){return"tv"===this.type}}var $r=Object.defineProperty,Gr=Object.getOwnPropertySymbols,Fr=Object.prototype.hasOwnProperty,Yr=Object.prototype.propertyIsEnumerable,Ur=(e,t,r)=>t in e?$r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Zr=(e,t)=>{for(var r in t||(t={}))Fr.call(t,r)&&Ur(e,r,t[r]);if(Gr)for(var r of Gr(t))Yr.call(t,r)&&Ur(e,r,t[r]);return e};const Wr=(()=>{var e;const t=null==(e=window.YandexGamesSDK)?void 0:e.game.info;if(!t)return;const r=parseInt(t.appId,10);return r?{appId:r,developerId:t.publisher.id}:void 0})();var Br=r(462);function Kr(e,t){t&&(e.type=t),l.Z.postToParent({data:e,type:"error"}).catch((e=>{console.warn(e)}))}function Hr(e){return{data:{additional:{sdkVersion:2}},error:e,source:"game",sourceMethod:(0,c.Zi)(e.stack)}}const Vr=new class{constructor(e){this.source=e,window.addEventListener("error",this),"Promise"in window&&window.addEventListener("unhandledrejection",this)}addLogger(e){this.logger=e}handleEvent(e){this._handleEvent(e)}_handleEvent(e,t="error"){try{this._unsafeHandleEvent(e,t)}catch(e){console.warn("Couldn't handle event in ErrorCounter!",e)}}_unsafeHandleEvent(e,t){return"unhandledrejection"===e.type?this._unsafeHandlePromiseRejectionEvent(e):this._unsafeHandleErrorEvent(e,t)}_unsafeHandlePromiseRejectionEvent(e){var t;const{reason:r}=e;if(!r)return;let n;const o={};r.stack&&r.message?n=r.message:(n=String(r),"[object Event]"===n?n="event.type: "+r.type:"[object Object]"===n&&(o.unhandledObject=r)),(null==(t=r.target)?void 0:t.src)&&(o.src=r.target.src),this._postError({additional:o,message:"Unhandled rejection: "+n,name:"UnhandledPromiseError",stack:r.stack||""},"unhandled")}_unsafeHandleErrorEvent(e,t){var r,n,o,a,s;const{error:i}=e,c={columnNumber:null!=(n=null!=(r=e.colno)?r:null==i?void 0:i.columnNumber)?n:-1,fileName:e.filename||(null==i?void 0:i.fileName)||"",lineNumber:null!=(a=null!=(o=e.lineno)?o:null==i?void 0:i.lineNumber)?a:-1,message:e.message||(null==i?void 0:i.message)||"",name:(null==i?void 0:i.name)||"Error",stack:null!=(s=null==i?void 0:i.stack)?s:""};(Wr||(null==i?void 0:i.additional))&&(c.additional=Zr(Zr({},null==i?void 0:i.additional),Wr)),this._postError(c,t)}_postError(e,t){var r;let n=(0,c.Zi)(e.stack);"ErrorListener.handleEvent"===n&&(n="unknown"),null==(r=this.logger)||r.call(this,{data:{additional:e.additional||{}},error:e,source:this.source,sourceMethod:n},t)}}("game");Vr.addLogger(Kr),function(){try{const e=console.error;console.error=(...t)=>{let r=t.filter((e=>e instanceof Error))[0];r||(r=(0,Br.Z)(t));try{"string"==typeof t[1]&&t[1]===c.X4?t.pop():Kr(Hr(r),"console.error")}catch(e){}e.apply(console,t)}}catch(e){try{Kr(Hr(e),"error")}catch(e){}}}();var zr=(e=>(e.AudioAPI="AudioAPI",e.LoadingAPI="LoadingAPI",e))(zr||{}),qr=(e=>(e.GameInit="loading_api_game_init",e.GameReady="loading_api_game_ready",e.GameReadyForce="loading_api_game_ready_force",e.IframeAdded="loading_api_iframe_added",e.IframeError="loading_api_iframe_resources_error",e.IframeLoaded="loading_api_iframe_resources_loaded",e.ScriptInit="loading_api_script_init",e.TTIReady="loading_api_tti_ready",e))(qr||{});const Jr=["LoadingAPI"],Xr=30*f;const Qr={[zr.LoadingAPI]:class{constructor(){this.isReady=!1,this.startTimestamp=Date.now(),this.startReadyFallbackTimeout()}ready(){if(this.isReady)return void console.warn("Don't call %cfeatures.LoadingAPI.ready() %cmore than one time.","color: green","color: unset");this.isReady=!0;const e=Date.now()-this.startTimestamp;this.logGameInitTime(e,qr.GameReady),clearTimeout(this.readyFallbackTimerId)}logGameInitTime(e,t){l.Z.postToParent({type:"game-measuring",action:t,data:{timeFromInit:e}})}startReadyFallbackTimeout(){this.readyFallbackTimerId=setTimeout((()=>{this.isReady=!0,this.logGameInitTime(Xr,qr.GameReadyForce)}),Xr)}}};class en{constructor(e={}){for(let t in zr)zr[t]in e&&e[zr[t]]&&(this[t]=new Qr[t]);for(let t of Jr)!this[t]&&(t in e&&e[t]||!(t in e))&&(this[t]=new Qr[t]);l.Z.postToParent({type:"game-measuring",action:qr.GameInit})}}zr.LoadingAPI;const tn=new class{canReview(){return new Promise((e=>{const t=L("Feedback.canReview");l.Z.postToParent({type:"feedback",action:"can-review"}).then((({data:t})=>{e(t)})).catch((t=>{(0,c.fF)(t),e({reason:"UNKNOWN",value:!1})})).finally((()=>{t()}))}))}requestReview(){return new Promise((e=>{const t=L("Feedback.requestReview",2*y);l.Z.postToParent({type:"feedback",action:"request-review"}).then((({data:t})=>{const{feedbackSent:r,reason:n}=t;n?((0,c.fF)(n),e({feedbackSent:null!=r&&r})):e({feedbackSent:null==r||r})})).catch((t=>{(0,c.fF)(t),e({feedbackSent:!1})})).finally((()=>{t()}))}))}};function rn(){!function(){var e;null==(e=window.top)||e.postMessage({type:"foolproof-sdk-init",url:location.href,draftDetectedInIframe:(0,u.mv)()},"*")}()}function nn(e){try{return"WebGLRenderingContext"in window&&Boolean(e.getContext("webgl")||e.getContext("experimental-webgl")instanceof WebGLRenderingContext)}catch(e){(0,c.fF)(e,{sourceMethod:"isWebGLSupported",level:"warn"})}return!1}function on(e){try{return"WebGL2RenderingContext"in window&&Boolean(e.getContext("webgl2")||e.getContext("experimental-webgl2")instanceof WebGL2RenderingContext)}catch(e){(0,c.fF)(e,{sourceMethod:"isWebGL2Supported",level:"warn"})}return!1}function an(){const e=[];return"createUnityInstance"in window&&e.push("unity"),e}function sn(){const e=[],t={webassembly:"WebAssembly"in window,webgl:nn(document.createElement("canvas")),webgl2:on(document.createElement("canvas"))};return Object.keys(t).filter((e=>t[e])).forEach((t=>{e.push(t)})),e}const cn={allow(){l.Z.postToParent({type:"notifications",action:"allow"})}};function ln(...e){const t=e=>e&&"object"==typeof e;return e.reduce(((e,r)=>(Object.keys(r).forEach((n=>{const o=e[n],a=r[n];Array.isArray(o)&&Array.isArray(a)?e[n]=o.concat(...a):t(o)&&t(a)?e[n]=ln(o,a):e[n]=a})),e)),{})}function dn(e){if(!e||"object"!=typeof e)return{};!function(e){"partnerId"in e&&(delete e.partnerId,console.warn("`partnerId` is deprecated in the SDKv2"))}(e);return["adv","screen"].reduce(((t,r)=>(r in e&&(t=e[r]),t)),{})}function un(e,t={}){return dn(t),function(e={}){return function(e){Ne||(e.advBlocks.fullscreen=wt.FULLSCREEN,e.advBlocks.fullscreen_landscape=wt.FULLSCREEN)}(e),function(e){"adv"in e&&He.sendOnceDeprecatedUsage("SDK init options with adv");e.adv=e.adv||{},function(e){if("onAdvClose"in e&&"function"!=typeof e.onAdvClose)throw new Error('"onAdvClose" must be a function')}(e.adv)}(e),function(e){if("screen"in e&&"object"!=typeof e.screen)throw new Error("Wrong screen options type");let t=e.screen||{};t=function(e,t){"fullscreen"in e?function(e){if("boolean"!=typeof e)throw new Error("Wrong fullscreen value")}(e.fullscreen):e.fullscreen="desktop"!==t;return e}(t,e.deviceType),t=function(e){if("orientation"in e){const{orientation:t}=e;"string"==typeof t&&(e.orientation={value:t,lock:!0}),function(e){if("object"!=typeof e)throw new Error("Wrong orientation value");if(![null,"portrait","landscape"].includes(e.value))throw new Error(`Wrong orientation value ("${e.value}")`);if("lock"in e){if("boolean"!=typeof e.lock)throw new Error(`Wrong orientation lock value ("${e.lock}")`)}else e.lock=!0}(e.orientation)}else e.orientation={value:null,lock:!0};return e}(t),e.screen=t}(e),e}(ln(e||{},t))}function pn(){return new Promise(((e,t)=>{const r=L("loadOptions");l.Z.postToParent({type:"options",action:"get"}).then((({data:t})=>{e(t)})).catch((e=>{t(e)})).finally((()=>{r()}))}))}const hn=(e={})=>zt(e),mn={AVATAR:"avatar",NAME:"public_name"},gn="personal_info";Object.keys(mn).map((e=>mn[e]));var fn=(e=>(e.ALLOW="allow",e.FORBID="forbid",e.NOT_SET="not_set",e))(fn||{});class yn{constructor(e={},t){this._scopePermissions=e,this._requestedScopes=this._validateRequestedScopes(t)}show(){return new Promise(((e,t)=>{l.Z.postToParent({type:"scopes",action:"open-scopes-dialog"}).then((({data:t})=>{e(t.result),l.Z.postToParent({type:"scopes",action:"focus"})})).catch(t)}))}isNeedToAskUser(){return[mn.AVATAR,mn.NAME].some((e=>this._requestedScopes.includes(e)&&this._scopePermissions[e]===fn.NOT_SET))}_validateRequestedScopes(e){let t=[];t=Array.isArray(e)?Array.from(e):void 0===e||!0===e?[gn]:[];const r=t.indexOf(gn);return-1!==r&&t.splice(r,1,mn.AVATAR,mn.NAME),t}}const wn=class{constructor(){this.promiseWrappers=Object.create(null)}getKey(e){return JSON.stringify(e)}getFor(e){return this.promiseWrappers[this.getKey(e)]}setFor(e,t){t?this.promiseWrappers[this.getKey(e)]=t:delete this.promiseWrappers[this.getKey(e)]}clear(){this.promiseWrappers=Object.create(null)}};var vn=(e,t,r)=>new Promise(((n,o)=>{var a=e=>{try{i(r.next(e))}catch(e){o(e)}},s=e=>{try{i(r.throw(e))}catch(e){o(e)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,s);i((r=r.apply(e,t)).next())}));const bn=I("PlayerProxy",E.Dev),En=5*y;const Pn=new wn,_n=new R;let On=!1;function Sn(e={},t=!0){const r=Pn.getFor(e);if(r&&!1!==t)return r.promise;const n=L("getPlayer"),o=new R;if(o.promise.finally((()=>{n()})),!1!==t){if(Pn.setFor(e,o),window.setTimeout((()=>{Pn.setFor(e,void 0)}),En),!On){On=!0,n();const e=L("get-permission-promise",2*y);l.Z.postToParent({type:"guard",action:"get-permission-promise"}).then((({data:e})=>{const{result:t}=e;_n.resolve(t)})).finally((()=>{e()}))}}else _n.resolve(void 0);const a=L("player/fetch");return l.Z.postToParent({type:"player",action:"fetch",data:{config:e}}).then((r=>vn(this,[r],(function*({data:r}){a();const{data:n,signature:s}=r,i=yield _n.promise;i&&[fn.ALLOW,fn.FORBID].includes(i)&&("avatar"in n.scopePermissions&&(n.scopePermissions.avatar=i),"public_name"in n.scopePermissions&&(n.scopePermissions.public_name=i));const c=function(e,t,r){const n=new mr(t,e);return Kt(n,r),n}(e,n,s);if("lite"===c.getMode()||V())o.resolve(c);else{const r=new yn(n.scopePermissions,e.scopes);if(t&&r.isNeedToAskUser()){const t=L("scopesChecker",2*y);r.show().then((()=>Sn(e,!1))).catch((()=>c)).then((e=>o.resolve(e))).finally((()=>{t()}))}else o.resolve(c)}})))).catch((t=>{a(),o.reject(t),Pn.setFor(e,void 0)})),o.promise}function An(e={}){return Sn(e,!0)}function In(e){var t;e&&(e.focus(),null==(t=e.contentWindow)||t.focus(),e.onload=function(){var t;null==(t=e.contentWindow)||t.focus()})}l.Z.onExternalMessage("auth",(e=>{["auth-dialog-cancel","auth-dialog-success","changed"].includes(e.data.action)&&(bn("Clear getPlayer promises."),Pn.clear())}));class xn{constructor(){this.onMessage=e=>{const{action:t}=e.data;"fullscreenchange"===t?(document.dispatchEvent(new Event("fullscreenchange")),this._status=e.data.data.isFullscreen?"on":"off"):"iframe-focus"===t&&this.iframeFocus()},this._status="off",this.overrideBrowserFullscreenElement(),this.initMessaging(),this.updateStatus()}get STATUS_ON(){return"on"}get STATUS_OFF(){return"off"}get status(){return this._status}request(){const e=L("FullscreenManager.request"),t=l.Z.postToParent({type:"screen-manager",action:"request-fullscreen"});return t.finally((()=>{e()})),t}exit(){const e=L("FullscreenManager.exit"),t=l.Z.postToParent({type:"screen-manager",action:"exit-fullscreen"});return t.finally((()=>{e()})),t}toggle(){const e=L("FullscreenManager.toggle"),t=l.Z.postToParent({type:"screen-manager",action:"toggle-fullscreen"});return t.finally((()=>{e()})),t}iframeFocus(){In(document.querySelector("iframe"))}updateStatus(){l.Z.postToParent({type:"screen-manager",action:"get-state"}).then((e=>{const{isFullscreen:t}=e.data;this._status=t?"on":"off"}))}overrideBrowserFullscreenElement(){try{Object.getOwnPropertyDescriptor(document,"fullscreenElement")||Object.defineProperty(document,"fullscreenElement",{enumerable:!1,configurable:!0,get:()=>this.status===this.STATUS_ON?document.documentElement:null})}catch(e){(0,c.fF)(e)}}initMessaging(){l.Z.onExternalMessage("screen-manager",this.onMessage)}}class Tn{constructor(){this.fullscreen=new xn}}var kn=(e=>(e.EXIT="EXIT",e.HISTORY_BACK="HISTORY_BACK",e))(kn||{});const Dn={[kn.EXIT]:!0};function Rn(){const e={[kn.HISTORY_BACK]:[]};function t(t){const r=e[t];return r||console.warn(`Yandex SDK Event ${t} is not in supported`),r||[]}function r(e){l.Z.postToParent({type:"sdk-internal-event",action:"listeners-change",data:{event:e,count:t(e).length}})}return l.Z.onExternalMessage("sdk-event",(r=>{const n=r.data.action;n in e&&t(n).forEach((e=>{try{e()}catch(e){(0,c.fF)(e)}}))})),function(n,o){return n in e?(function(e,n){t(e).push(n),r(e)}(n,o),()=>{!function(e,n){const o=t(e),a=o.indexOf(n);-1!==a&&(o.splice(a,1),r(e))}(n,o)}):(console.warn("Yandex SDK Event",n,`is not in supported. Available events: ${Object.keys(e).join}`),()=>{})}}const Cn=["passport.ya","passport.yandex","an.yandex.ru","avatars.mds.yandex.net","/api/"];function Ln(e){const t=Cache.prototype[e];Cache.prototype[e]=function(e,r){return"GET"!==e.method||0!==e.url.indexOf("https://")||(n=e.url,Cn.some((e=>-1!==n.indexOf(e))))?Promise.resolve():("ignoreSearch"in(r=r||{})||(r.ignoreSearch=!0),t.call(this,e,r));var n}}const Nn=class{static overrideCacheSearch(){("function"!=typeof Cache?(console.warn("Can not find `Cache` function"),0):"function"!=typeof Cache.prototype.match?(console.warn("Can not find `Cache.match` function"),0):"function"==typeof Cache.prototype.matchAll||(console.warn("Can not find `Cache.matchAll` function"),0))&&(Ln("match"),Ln("matchAll"))}};const Mn=new class{canShowPrompt(){return new Promise((e=>{const t=L("Shortcut.canShowPrompt");l.Z.postToParent({type:"shortcut-manager",action:"can-show-prompt"}).then((({data:t})=>{e(t)})).catch((e=>{(0,c.fF)(e)})).finally((()=>{t()}))}))}showPrompt(){return new Promise((e=>{const t=L("Shortcut.showPrompt",2*y);l.Z.postToParent({type:"shortcut-manager",action:"show-prompt"}).then((({data:t})=>{e(t)})).catch((e=>{(0,c.fF)(e)})).finally((()=>{t()}))}))}};function jn(e){window.setTimeout((()=>{var t,r,n,o;const a={borrowParams:{[`tmpPlayTime${e}`]:{appVersion:window.APP_VERSION}}},s=new Image,i=(null==(r=null==(t=window.YandexGamesSDKEnvironment)?void 0:t.i18n)?void 0:r.tld)||"ru",c=ge(null==(o=null==(n=window.YandexGamesSDKEnvironment)?void 0:n.data)?void 0:o.secondDomain);s.src=`https://mc.yandex.${i}/watch/${c}?page-url=${encodeURIComponent(window.location.href)}&page-ref=${encodeURIComponent(document.referrer)}&charset=utf-8&site-info=${encodeURIComponent(JSON.stringify(a))}`}),1e3*e)}const $n=function(){jn(5),jn(60),jn(900)};const Gn=new wn;function Fn(e={}){const{clientFeatures:t=[],defaultFlags:r={}}=e,n=Gn.getFor(e);if(n)return n.promise;const o=L("get_flags/fetch"),a=new R;return a.promise.finally((()=>{o()})),Gn.setFor(e,a),l.Z.postToParent({type:"varioqub",action:"fetch",data:{clientFeatures:t}}).then((({data:e})=>{const t=Object.assign(r,e);a.resolve(t)})).catch((()=>{a.resolve(r),Gn.setFor(e,void 0)})),a.promise}var Yn=r(651);function Un(){return new Promise((e=>{if("loading"===document.readyState){const t=r=>{const{target:n}=r;n&&"loading"!==n.readyState&&(n.removeEventListener("readystatechange",t),e())};document.addEventListener("readystatechange",t)}else e()}))}var Zn=Object.defineProperty,Wn=Object.defineProperties,Bn=Object.getOwnPropertyDescriptors,Kn=Object.getOwnPropertySymbols,Hn=Object.prototype.hasOwnProperty,Vn=Object.prototype.propertyIsEnumerable,zn=(e,t,r)=>t in e?Zn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const qn=(e=null)=>{var t;null===e&&(e=window),["testing","prestable","production"].includes("production")&&!O&&(/iPad|iPhone|iPod/.test(window.navigator.platform)||window.navigator.userAgent.includes("Mac")&&"ontouchend"in document)&&(e.console=(t=((e,t)=>{for(var r in t||(t={}))Hn.call(t,r)&&zn(e,r,t[r]);if(Kn)for(var r of Kn(t))Vn.call(t,r)&&zn(e,r,t[r]);return e})({},console),Wn(t,Bn({log:()=>{},error:()=>{},info:()=>{},debug:()=>{},warn:()=>{},trace:()=>{},dir:()=>{},dirxml:()=>{},group:()=>{},groupEnd:()=>{},time:()=>{},timeEnd:()=>{},assert:()=>{},profile:()=>{}}))))};const Jn=I("sdkv2",E.Dev);!function(){var e;if((0,u.mv)())Rr("alert hook disabled");else try{"function"==typeof window.alert&&(e=window.alert,window.alert=function(){const t=arguments[0];return Rr(`alert message = ${t}`),l.Z.postToParent({type:"game-call-alert",data:{message:t.substring(0,Cr)}}),e.apply(this,arguments)}),window.addEventListener("load",Nr,{once:!0}),Rr("alert hook enabled")}catch(e){(0,c.fF)(e,{prefix:"game_hook_alert exp error: ",level:"warn"})}}(),V()&&(localStorage.clear(),indexedDB.databases().then((e=>{e.forEach((e=>{e.name&&indexedDB.deleteDatabase(e.name)}))})));let Xn,Qn,eo=Promise.resolve();eo=function(r){if(window.loadPolyfillsPromise)return window.loadPolyfillsPromise;let n=[[e.LEGACY,Boolean(Array.prototype.at)],[e.INTERSECTION_OBSERVER,Boolean("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)],[e.SMOOTH_SCROLL,Boolean("scrollBehavior"in document.documentElement.style)],[e.ABORT_CONTROLLER,"undefined"!=typeof AbortController]].filter((([,e])=>!e));return window.loadPolyfillsPromise=new Promise(((e,t)=>{n.length?o({id:"loadPolyfillHash",src:s(r,"hash-polyfill.js"),parentElement:document.head,onErrCb:t,onLoadCb:e}):e()})).then((()=>Promise.all(n.map((([e])=>new Promise(((t,n)=>{o({id:e,src:i(r,e),parentElement:document.head,onErrCb:n,onLoadCb:t})}))))))),window.loadPolyfillsPromise.catch((e=>{(0,t.H)({block:a.W.POLYFILL,message:"Error while loading polyfills",additional:{error:e}})})),window.loadPolyfillsPromise}("//yastatic.net/s3/games-static/_/build");eo=eo.then((()=>{be&&(qn(),window.alert=e=>console.warn("Overridden alert: "+e)),(()=>{if(window.top!==window)return;const{hostname:e}=window.location;if(!/(games\.s3\.yandex\.net|games-storage(-awst?)?\.yandex\.net)$/.test(e))return;const t=(0,u.rh)();if(!t)return;const{search:r,hash:n}=window.location;let o;o=/games\.s3\.yandex\.net$/.test(e)?`https://${h(e)?"ya":"yandex"}.ru/games/app/${t}${r}${n}`:`https://yandex.com/games/app/${t}${r}${n}`,window.top.location.replace(o)})(),rn()})),Jn("APP_VERSION","1702033910");class to{constructor(e){var t,r;e=un(e),this.EVENTS={EXIT:kn.EXIT,HISTORY_BACK:kn.HISTORY_BACK},this.dispatchEvent=function(e,t){const r=L("getSdkEventsDispatcher");return new Promise(((n,o)=>{if(!(e in Dn)){const t=`Yandex SDK Event ${e} is not in supported.`;return console.warn(t),void o(new Error(t))}const a={action:e,type:"sdk-event"};if(void 0!==t)try{a.data={detail:JSON.stringify(t)}}catch(e){return console.warn(e),void o(new Error('Wrong "detail" argument'))}l.Z.postToParent(a).then((()=>{n(!0)})).catch((e=>{o(e)})).finally((()=>{r()}))}))},this.onEvent=Rn(),this.achievements=G.init(),this.adv=new Oe(e),this.auth=Se,this.clipboard=Mr,this.deviceInfo=new jr(e.deviceType),no.deviceInfo=this.deviceInfo,this.environment=Xt,this.feedback=tn,this.isAvailableMethod=(r=this,e=>{if(V()&&["leaderboards.setLeaderboardScore"].includes(e))return Promise.resolve(!0);const t=L("isAvailableMethod"),n=l.Z.postToParent({type:"auth",action:"has-auth"}).then((({data:t})=>{const{hasAuth:n}=t;if(!n&&function(e){return["feedback.requestReview","leaderboards.getLeaderboardPlayerEntry","leaderboards.setLeaderboardScore","player.getIDsPerGame"].includes(e)}(e))return!1;const o={leaderboards:Ct,payments:Vt,player:mr,storage:_r.getCustomLocalStorage()};if(o[e])return!1;const a=e.split(".");let s=Dr(Dr({},o),r);for(let e=0;e<a.length;e++){const t=s[a[e]];if(!t)return!1;if(e===a.length-1)return"function"==typeof t;if(!Sr(t))return!1;s=Sr(t.prototype)?t.prototype:t}return!1}));return n.finally((()=>{t()})),n}),this.shortcut=Mn,this.getLeaderboards=Lt,this.getPayments=hn,this.getPlayer=An,this.getStorage=Or,this.notifications=cn,this.screen=new Tn,this.features=new en(e.features),this.yandexApp={enabled:Boolean(null==(t=window.YandexGamesSDKEnvironment)?void 0:t.isYandexApp)},this.getFlags=Fn}}function ro(e){if("complete"===document.readyState)e();else{const t=()=>{e(),window.removeEventListener("load",t)};window.addEventListener("load",t)}}eo=eo.then((()=>{window.loadEnvironmentPromise=window.loadEnvironmentPromise||new Promise(((e,t)=>{const r=L("loadEnvironment");l.Z.postToParent({type:"environment",action:"get"}).then((({data:t})=>{e(t)})).catch((e=>{t(e)})).finally((()=>{r()}))})).then((e=>{window.YandexGamesSDKEnvironment=e})),function(e){const t=ht(e,2e3),r=["click","keydown","keyup","mousedown","mouseenter","mouseleave","mouseup","pointerup","touchcancel","touchend","touchmove","touchstart"];r.forEach((e=>document.addEventListener(e,t,{passive:!0,capture:!0})))}((()=>l.Z.postToParent({type:"user-action"})))}));try{Qn=new URLSearchParams(window.location.hash.slice(1)).get("device-type")}catch(e){}class no{constructor(){throw new Error("Please, use `YaGames.init` instead.")}static longtaskObserver(){var e;const t="longtask";if("undefined"!=typeof PerformanceObserver&&(null==(e=PerformanceObserver.supportedEntryTypes)?void 0:e.includes(t))){let e;const r=()=>{clearTimeout(e),e=setTimeout((()=>{"complete"===document.readyState?n.disconnect():r()}),Yn.Tc)},n=new PerformanceObserver((e=>{e.getEntries().forEach((()=>{l.Z.postToParent({type:"longtask"}),r()}))}));n.observe({entryTypes:[t]})}"complete"===document.readyState?l.Z.postToParent({type:"longtask_frame_ready"}):window.addEventListener("load",(()=>{l.Z.postToParent({type:"longtask_frame_ready"})}))}static init(e){return t=this,r=null,n=function*(){return Xn?(console.warn("YaGames was initialized"),Xn):(this.longtaskObserver(),Jn("Start initialization"),yield eo,Xn=new Promise(((t,r)=>{!function(){const e=()=>{l.Z.postToParent({type:"sdk_initialization",data:{initialized:!0}}),window.removeEventListener("load",e)};"complete"===document.readyState?e():window.addEventListener("load",e)}();const n=n=>{try{if(!(e=un(n,e)).deviceType)try{e.deviceType=new URLSearchParams(window.location.hash.slice(1)).get("device-type")}catch(e){(0,c.fF)(e,{message:"No deviceType in options"})}Un().then((()=>{const r=new to(e);r.environment.isTelegram&&lt("loading",{value:100}),e.hasAuth&&r.getPlayer({scopes:!1}),t(r)}))}catch(e){(0,c.fF)(e),r(e)}};window.loadEnvironmentPromise.then((()=>{pn().then(n).catch((e=>{console.warn(`Options load failed with error ${e}`),n()}))})).catch((e=>{(0,c.fF)(e),pn().then(n).catch((e=>{console.warn(`Options load failed with error ${e}`),n()}))})),setTimeout((()=>{const e={clientTech:sn(),gameTech:an()};Jn("checkAndSendGameInfo tech data:",e),ro((()=>{l.Z.postToParent({type:"game-stats",data:e})}))}),10*f)})),Xn.then((()=>Jn("Initialized"))),Xn)},new Promise(((e,o)=>{var a=e=>{try{i(n.next(e))}catch(e){o(e)}},s=e=>{try{i(n.throw(e))}catch(e){o(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,s);i((n=n.apply(t,r)).next())}));var t,r,n}}if(no.deviceInfo=new jr(Qn),window.YaGames&&window.YaGamesAdded){const e='YaGames is already defined. Please, check double <script src="https://ya.ru/games/sdk/v2"> on the page.';(0,u.mv)()&&window.parent.postMessage({source:"YandexGamesSDK",type:"alert",message:e},"*"),(0,c.Ts)(new Error(e))}else{window.parent!==window&&window.parent.postMessage({source:"YandexGamesSDK",type:"sdk-bundle-start",messageId:`${Date.now()}-${Math.random()}`,data:{time:Date.now(),sdkVersion:"v2",sdkBundle:"1702033910"}},"*");try{_r.setup()}catch(e){(0,c.fF)(e)}window.top!==window&&Un().then(d),In(document.querySelector("iframe")),Nn.overrideCacheSearch(),$n(),"SecurityPolicyViolationEvent"in window?window.addEventListener("securitypolicyviolation",(({blockedURI:e,columnNumber:t,disposition:r,documentURI:n,effectiveDirective:o,lineNumber:a,originalPolicy:s,referrer:i,sample:c,sourceFile:d,statusCode:u,violatedDirective:p})=>{l.Z.postToParent({type:"csp",action:"violation",data:{blockedURI:e,columnNumber:t,disposition:r,documentURI:n,effectiveDirective:o,lineNumber:a,originalPolicy:s,referrer:i,sample:c,sourceFile:d,statusCode:u,violatedDirective:p}})})):console.warn("SecurityPolicyViolationEvent is not available for this browser")}ro((()=>{l.Z.postToParent({type:"frame",action:qr.IframeLoaded})})),window.YaGamesAdded=!0,window.YaGames=no;const oo=no})(),YaGames=n.default})();
//# sourceMappingURL=https://s3.mdst.yandex.net/games/source-maps/_/sdk/v2.a9b81e84bf321ad9bcfe.js.map